(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[22],{1063:function(e,t,n){"use strict";n.r(t);var a=n(188),r=n(353),i=n(0),c=n(73),o=n(33),s=n(51),l=(n(48),n(10)),d=n(35),u=n(90),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return function(){var n=Object(s.a)(Object(o.a)().mark((function n(a){var r,i,c;return Object(o.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:l.v}),n.next=4,Object(u.b)({uri:"/api/users?page=".concat(e+1,"&limit=").concat(t)});case 4:r=n.sent,i=r.success,c=r.data,i||Object(d.a)(c.message,"error"),a({type:l.x,payload:c||[]}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),a({type:l.w});case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()},b=function(){return{type:l.T}},f=n(445),h=n(3),O=n(4),p=n(14),m=n(1075),x=n(1076),v=n(1047),g=n(97),w=n(498),y=n(91),C=n(446),k=n(30),D=n(38),S=n(196),R=n(1),P={email:"",password:"",role:"dispatch"},A=function(){var e=Object(C.a)("/api/users"),t=e.mutation,n=e.loading,a=Object(i.useState)(Object(O.a)({},P)),u=Object(p.a)(a,2),f=u[0],A=u[1],F=Object(c.e)((function(e){return e.users})),I=F.loading,N=F.open,E=F.error,U=F.user,z=F.page,M=F.limit,W=Object(C.a)("/api/users/".concat(null===U||void 0===U?void 0:U._id)),_=W.mutation,H=W.loading,T=Object(c.e)((function(e){return e.auth})).user,q=void 0===T?{}:T,J=Object(c.e)((function(e){return e.auth})).roles,L=void 0===J?[]:J,K=Object(c.d)(),V=Object(i.useState)(),B=Object(p.a)(V,2),G=B[0],Q=B[1];Object(i.useEffect)((function(){if(null!==q&&void 0!==q&&q.role.equalsIgnoreCase(D.f.superadmin))Q(L);else{var e=L.filter((function(e){return"driver"===e||"afterhours"===e||"load planner"===e||"support"===e||"dispatch"===e||"ownerOperator"===e}));Q(e)}}),[L]),Object(i.useEffect)((function(){N||Y()}),[N]),Object(i.useEffect)((function(){0===+z&&N&&(Y(),K(j(+z,+M)))}),[z]),Object(i.useEffect)((function(){if(U){var e=U.email,t=U.role;A((function(n){return Object(O.a)(Object(O.a)({},n),{},{email:e,role:t})})),K(b())}}),[U]);var X=function(e){var t=e.name,n=e.value;A((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(h.a)({},t,n))}))},Y=function(){A(Object(O.a)({},P)),K({type:l.eb})},Z=function(e,t){for(var n={},a=0,r=Object.keys(e);a<r.length;a++){var i=r[a];"password"!==i&&t[i]!==e[i]&&(n[i]=e[i]),"password"===i&&e[i]&&(n[i]=e[i])}return n};function $(e){var t=e.success,n=e.data;t?(Y(),K(j(+z,+M)),Object(d.a)((U._id?"Updated ":"Saved ")+"Successfully")):Object(d.a)(n.message,"error")}var ee=function(){var e=Object(s.a)(Object(o.a)().mark((function e(n){var a,r,i,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),I){e.next=21;break}if(U){e.next=18;break}if(a=f.email,r=f.password,i=f.role,a&&r&&i){e.next=8;break}return e.abrupt("return",alert("All fields are required"));case 8:if(Object(k.e)(a)){e.next=12;break}return e.abrupt("return",alert("Email is not valid"));case 12:if(!(r.length<6)){e.next=14;break}return e.abrupt("return",alert("Please enter password with 6 or more characters"));case 14:return e.next=16,t(f,"",$);case 16:e.next=21;break;case 18:return c=Z(f,U),e.next=21,_(c,"put",$);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(r.a,{color:"primary",variant:"contained",onClick:function(){K(b())},children:"Add User"}),Object(R.jsxs)(m.a,{fullWidth:!1,maxWidth:"md",open:N,onClose:Y,"aria-labelledby":"form-dialog-title",PaperProps:{sx:{width:400}},children:[Object(R.jsxs)(v.a,{id:"form-dialog-title",sx:{textAlign:"center",color:y.a},children:[U?"Update":"Add"," User"]}),E?Object(R.jsx)("p",{style:{textAlign:"center"},children:E}):"",Object(R.jsx)(x.a,{sx:{p:0,overflow:"hidden"},children:Object(R.jsx)("div",{className:"",children:Object(R.jsx)("form",{noValidate:!0,onSubmit:ee,children:Object(R.jsxs)(g.a,{container:!0,spacing:2,direction:"column",sx:{p:3},children:[Object(R.jsx)(g.a,{item:!0,children:Object(R.jsx)(S.b,{name:"email",label:"Email",onChange:X,value:f.email,autoFocus:!0,fullWidth:!0})}),Object(R.jsx)(g.a,{item:!0,children:Object(R.jsx)(S.d,{name:"password",label:"Password",onChange:X,value:f.password,fullWidth:!0})}),Object(R.jsx)(g.a,{item:!0,children:Object(R.jsx)(S.e,{onChange:X,label:"Role",name:"role",value:f.role,options:G&&G.map((function(e){return{id:e,label:Object(w.a)(e)}}))})}),Object(R.jsx)(g.a,{item:!0,xs:12,justifyContent:"center",display:"flex",children:Object(R.jsx)(S.c,{isLoading:n||H,className:"",type:"submit",variant:"contained",color:"primary",children:"Submit"})})]})})})})]})]})},F=n(567);t.default=function(){var e=Object(c.e)((function(e){return e.users})),t=e.list,n=e.loading,o=e.page,s=void 0===o?0:o,d=e.limit,u=void 0===d?5:d,b=e.total,h=Object(c.e)((function(e){return e.auth})).user,O=Object(c.d)(),p=function(e){e.success&&O(j(+s,+u))};Object(i.useEffect)((function(){O(j(+s,+u))}),[O]);var m=[D.f.dispatch,D.f.admin,D.f.superadmin],x={emptyMessage:"No Users found",page:s,count:b,limit:u,onPageChange:function(e,t){O(j(t-1,+u))},rowCellPadding:"normal",showRefresh:!0,columns:[{id:"name",label:"Name",emptyState:"--",renderer:function(e){var t=e.row,n=t.name,a=void 0===n?"":n,r=t.firstName,i=t.lastName;return a||"".concat(r||"--"," ").concat(i||"")}},{id:"email",label:"Email"},{id:"role",label:"Role"},{id:"actions",label:"Actions",renderer:function(e){var t=e.row,n=void 0===t?{}:t,a=n._id,c=n.email,o=n.role,s=e.role;return Object(R.jsxs)(i.Fragment,{children:[m.includes(s)&&Object(R.jsx)(r.a,{variant:"contained",sx:{mr:1},onClick:function(){O(function(e){return{type:l.hb,payload:e}}({_id:a,email:c,role:o}))},children:"Update"}),h&&[D.f.admin,D.f.superadmin].includes(h.role)&&Object(R.jsx)(r.a,{variant:"contained",color:"error",onClick:Object(F.b)({message:"Are you sure you want to delete "+c+"?",uri:"/api/users/".concat(a),afterSuccessCb:p}),children:"Delete"})]})}}]};return Object(R.jsxs)(i.Fragment,{children:[Object(R.jsx)(f.a,{loading:n,data:t,config:x,onRefetch:function(){return O(j(+s,+u))}}),Object(R.jsx)(a.a,{sx:{display:"flex",justifyContent:"flex-end"},children:Object(R.jsx)(A,{})})]})}},445:function(e,t,n){"use strict";var a=n(188),r=n(429),i=n(1082),c=n(1083),o=n(256),s=n(467),l=n.n(s),d=n(1081),u=n(1080),j=n(1070),b=n(97),f=n(43),h=n(14),O=n(257),p=n(27),m=n(1079),x=n(4),v=n(478),g=n.n(v),w=n(3),y=n(1078),C=n(119),k=n.n(C),D=n(456),S=n.n(D),R=n(0),P=n.n(R),A=n(34),F=n(1055),I=n(7),N=n(1),E=Object(I.a)(F.a)((function(e){var t=e.theme;return{"& .MuiPaginationItem-root":Object(w.a)({},t.breakpoints.down("md"),{height:"1.8rem",width:"1rem"})}})),U=Object(I.a)(o.a)((function(e){var t,n=e.theme;return t={},Object(w.a)(t,n.breakpoints.down("sm"),{justifyContent:"center"}),Object(w.a)(t,"display","flex"),Object(w.a)(t,"justifyContent","space-between"),Object(w.a)(t,"flexWrap","wrap"),t})),z=function(e){var t=e.data,n=void 0===t?[]:t,a=e.onPageChange,r=e.page,i=void 0===r?0:r,c=e.count,o=void 0===c?0:c,s=e.limit,l=void 0===s?1:s,d=Object(R.useState)(0),u=Object(h.a)(d,2),j=u[0],b=u[1];Object(R.useEffect)((function(){Array.isArray(n)&&b(n.length)}),[n]);return j<10&&o<10?null:Object(N.jsxs)(U,{direction:"row",alignItems:"center",children:[o>10&&Object(N.jsxs)(f.a,{sx:{color:"#525F7F"},fontSize:12,children:["Showing ",n.length," of ",o," entries"]}),n.length!==o&&Object(N.jsx)(E,{count:Math.ceil(o/l),color:"primary",variant:"contained",page:i+1,size:"medium",onChange:function(e,t){a&&a(e,t)}})]})},M=n(355);function W(){return Object(N.jsx)(a.a,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center","& > * + *":{marginLeft:2}},children:Object(N.jsx)(M.a,{})})}var _=n(455),H=n(30),T=["row","columns","config","handleRowClick","rowIndex","handleDelete","hasDeletePermission"],q=["columns","data","config","handleRowClick","handleDelete"],J=Object(I.a)(y.a)((function(e){var t=e.theme;return Object(w.a)({},t.breakpoints.down("xs"),{fontSize:12,padding:"0 8px"})})),L=Object(I.a)(g.a)((function(e){var t=e.theme;return Object(w.a)({},t.breakpoints.down("xs"),{fontSize:14})}));function K(e){var t=e.columns,n=void 0===t?[]:t,a=e.config,r=void 0===a?{}:a,i=r.headerCellSx,c=void 0===i?{}:i,o=r.hasDelete,s=Object(R.useMemo)((function(){return n.map((function(e,t){var n=e||{},a=n.label,r=void 0===a?"":a,i=n.id,o=void 0===i?"":i,s=n.visible,l=void 0===s||s;return(k.a.isFunction(l)?l({column:e}):l)?Object(N.jsx)(J,{padding:"normal",sx:Object(x.a)({color:"#000",bgcolor:"#fafafa",fontWeight:800},c),children:r},o||t):null}))}),[n,c]);return Object(N.jsxs)(m.a,{children:[s,o&&Object(N.jsx)(J,{padding:"none",sx:Object(x.a)({},c)})]})}var V=function(e){var t=e.columns,n=e.data,a=void 0===n?[]:n,r=e.config,i=void 0===r?{}:r,c=e.handleRowClick,o=e.handleDelete,s=Object(p.a)(e,q);return(a||[]).map((function(e,n){var a=i.dataKey,r=void 0===a?"":a;return r&&(e=e[r]),function(e){var t=e.row,n=void 0===t?[]:t,a=e.columns,r=void 0===a?{}:a,i=e.config,c=void 0===i?{}:i,o=e.handleRowClick,s=e.rowIndex,l=e.handleDelete,d=e.hasDeletePermission,u=Object(p.a)(e,T),j=c.hasDelete,b=void 0!==j&&j,f=c.rowCellPadding,h=void 0===f?"none":f,v=c.onRowClick,g=void 0===v?void 0:v,w=c.rowStyleCb,y=u.role,C={};w&&(C=w({row:n})||{});var D=Object(N.jsx)(J,{sx:{},padding:"none",component:"th",scope:"row",children:Object(N.jsx)(O.a,{onClick:l.bind(void 0,n._id,n),disabled:!d,children:Object(N.jsx)(L,{color:"error"})})}),S=r.map((function(e,t){var a,r=e||{},i=r.id,c=void 0===i?"":i,o=r.renderer,l=r.emptyState,d=void 0===l?"":l,u=r.valueFormatter,j=r.visible,b=void 0===j||j;return(k.a.isFunction(b)?b({column:e}):b)?(a=u&&k.a.isFunction(u)?u(n[c]):k.a.isFunction(o)?o({row:n,role:y},s)||d:k.a.isObject(n)?k.a.get(n,c,d):n[c]||d,Object(N.jsx)(J,{padding:h||"normal",component:"th",scope:"row",children:a},c+t)):null}));return Object(N.jsxs)(m.a,{hover:!!g,onClick:function(e){e.preventDefault(),k.a.isFunction(o)&&o(n)},sx:g?Object(x.a)({cursor:"pointer"},C):Object(x.a)({},C),children:[S,b&&D]},s)}(Object(x.a)({row:e,columns:t,config:i,handleRowClick:c,rowIndex:n,handleDelete:o},s))}))},B=function(e){var t=e.config,n=void 0===t?{}:t,s=e.data,p=void 0===s?[]:s,m=e.history,v=e.loading,g=void 0!==v&&v,w=e.onRefetch,y=e.isRefetching;p=p||[];var C=Object(R.useState)({}),k=Object(h.a)(C,2),D=k[0],A=k[1],F=Object(R.useState)({open:!1,config:{}}),I=Object(h.a)(F,2),E=I[0],U=I[1],M=n.columns,T=void 0===M?[]:M,q=n.onRowClick,J=n.hasOnClickUrl,L=void 0===J||J,B=n.onPageChange,G=n.page,Q=n.count,X=n.limit,Y=n.size,Z=void 0===Y?"medium":Y,$=n.emptyMessage,ee=void 0===$?"":$,te=n.onRowClickDataCallback,ne=n.showRefresh,ae=void 0!==ne&&ne,re=n.onDelete,ie=n.deleteMessage,ce=n.deletePermissions,oe=void 0===ce?[]:ce,se=n.containerHeight,le=void 0===se?"":se,de=Object(H.d)().user.role,ue=void 0===de?"":de,je=oe.indexOf(ue)>-1||!1,be=P.a.useRef([]),fe=Array.isArray(p)&&p.length,he=function(e){if(L&&q){var t=q(e);te&&(e=te(e)),m.push(t,e)}else q&&q(e)},Oe=function(e,t,n){n.stopPropagation();var a={title:function(){return Object(N.jsxs)(b.a,{container:!0,alignItems:"center",sx:{p:"16px 24px"},gap:1,children:[Object(N.jsx)(S.a,{color:"error"}),Object(N.jsx)(f.a,{sx:{fontSize:"1.25rem",fontWeight:550},color:"error",children:"Delete"})]})},okText:"Delete",onOk:function(){return re(e,pe)},content:function(){return Object(N.jsx)(j.a,{sx:{color:"#000"},children:ie||"Are you sure you want to delete the record?"})}};U(Object(x.a)(Object(x.a)({},E),{},{open:!0,config:a}))};function pe(){U(Object(x.a)(Object(x.a)({},E),{},{open:!1}))}var me=Object(R.useMemo)((function(){return fe?Object(N.jsxs)(R.Fragment,{children:[Object(N.jsx)(u.a,{className:"",sx:{backgroundColor:"#fafafa",borderTop:"1px solid rgba(224, 224, 224, 1)"},children:Object(N.jsx)(K,{columns:T,config:n})}),Object(N.jsx)(d.a,{children:Object(N.jsx)(V,{role:ue,columns:T,data:p,config:n,handleRowClick:he,handleDelete:Oe,hasDeletePermission:je},Date.now())})]}):Object(N.jsx)("tbody",{style:{height:300},children:Object(N.jsx)("tr",{children:Object(N.jsx)("td",{style:{textAlign:"center"},children:Object(N.jsx)("h4",{children:ee||"No records found"})})})})}),[p,n]);return Object(R.useEffect)((function(){var e;if(null!==be&&void 0!==be&&null!==(e=be.current)&&void 0!==e&&e.table){var t=be.current.table.offsetHeight;A(Object(x.a)(Object(x.a)({},D),{},{height:t>200?t:void 0}))}}),[]),Object(N.jsxs)(a.a,{className:"enhanced-table",sx:{height:fe&&!g?le||"95%":"auto"},children:[ae&&Object(N.jsx)(o.a,{alignItems:"flex-end",children:Object(N.jsx)(O.a,{title:"Refresh",onClick:w,children:Object(N.jsx)(l.a,{className:y?"rotateIcon":void 0})})}),Object(N.jsx)(i.a,{component:r.a,className:"",sx:{boxShadow:"0px 0px 32px #8898AA26",mb:2,height:fe&&!g?"calc(100% - 64px)":"auto"},children:g?function(){var e=window.innerHeight-180,t=(D.height?D.height>e?e:D.height:e)||e;return Object(N.jsx)(b.a,{container:!0,alignItems:"center",justifyContent:"center",sx:{height:t},children:Object(N.jsx)(b.a,{item:!0,alignItems:"center",sx:{position:"relative"},children:Object(N.jsx)(W,{})})})}():Object(N.jsx)(c.a,{ref:function(e){return be.current.table=e},"aria-label":"caption table",size:Z,stickyHeader:!0,children:me})}),!g&&p.length>0&&Object(N.jsx)(z,{data:p,onPageChange:B,page:G,count:Q,limit:X}),Object(N.jsx)(_.a,{className:"enhancedTable_dialog",open:E.open,config:E.config,onClose:pe})]})};t.a=Object(A.withRouter)(Object(R.memo)(B))},498:function(e,t,n){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var r=function(e,t,n){return t!==n&&(Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(e,t)),delete e[t]),e}}}]);
//# sourceMappingURL=22.da5488fa.chunk.js.map