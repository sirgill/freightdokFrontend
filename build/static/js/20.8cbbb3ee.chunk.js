(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[20],{1049:function(e,t,n){"use strict";n.r(t);var a=n(185),o=n(247),i=n(0),r=n(67),c=n(21),s=n(39),l=(n(33),n(8)),d=n(23),u=n(55),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return function(){var n=Object(s.a)(Object(c.a)().mark((function n(a){var o,i,r;return Object(c.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(u.b)({uri:"/api/users?page=".concat(e+1,"&limit=").concat(t)});case 3:o=n.sent,i=o.success,r=o.data,i||Object(d.a)(r.message,"error"),a({type:l.x,payload:r||[]}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),a({type:l.w});case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},b=function(){return{type:l.T}},f=n(331),g=n(5),h=n(3),O=n(14),v=n(1064),p=n(1065),x=n(1027),m=n(85),w=n(393),y=n(121),C=n(68),I=n(340),k=n(635),P=n(20),S=n(31),L=n(1),R={email:"",password:"",role:"dispatch"},D=function(){var e=Object(I.a)("/api/users"),t=e.mutation,n=e.loading,a=Object(i.useState)(Object(h.a)({},R)),u=Object(O.a)(a,2),f=u[0],D=u[1],E=Object(r.e)((function(e){return e.users})),A=E.loading,F=E.open,M=E.error,z=E.user,N=E.page,U=E.limit,W=Object(I.a)("/api/users/".concat(null===z||void 0===z?void 0:z._id)),_=W.mutation,B=W.loading,T=Object(r.e)((function(e){return e.auth})).user,q=void 0===T?{}:T,H=Object(r.e)((function(e){return e.auth})).roles,J=void 0===H?[]:H,K=Object(r.d)(),V=Object(i.useState)(),G=Object(O.a)(V,2),Q=G[0],X=G[1];Object(i.useEffect)((function(){if(null!==q&&void 0!==q&&q.role.equalsIgnoreCase(S.e.superadmin))X(J);else{var e=J.filter((function(e){return"driver"===e||"afterhours"===e||"load planner"===e||"support"===e||"dispatch"===e}));X(e)}}),[]),Object(i.useEffect)((function(){F||Z()}),[F]),Object(i.useEffect)((function(){0===+N&&(Z(),K(j(+N,+U)))}),[N]),Object(i.useEffect)((function(){if(z){var e=z.email,t=z.role;D((function(n){return Object(h.a)(Object(h.a)({},n),{},{email:e,role:t})})),K(b())}}),[z]);var Y=function(e){var t=e.target,n=t.name,a=t.value;D((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(g.a)({},n,a))}))},Z=function(){D(Object(h.a)({},R)),K({type:l.eb})},$=function(e,t){for(var n={},a=0,o=Object.keys(e);a<o.length;a++){var i=o[a];"password"!==i&&t[i]!==e[i]&&(n[i]=e[i]),"password"===i&&e[i]&&(n[i]=e[i])}return n};function ee(e){var t=e.success,n=e.data;t?(Z(),K(j(+N,+U)),Object(d.a)((z._id?"Updated ":"Saved ")+"Successfully")):Object(d.a)(n.message,"error")}var te=function(){var e=Object(s.a)(Object(c.a)().mark((function e(n){var a,o,i,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),A){e.next=21;break}if(z){e.next=18;break}if(a=f.email,o=f.password,i=f.role,a&&o&&i){e.next=8;break}return e.abrupt("return",alert("All fields are required"));case 8:if(Object(P.f)(a)){e.next=12;break}return e.abrupt("return",alert("Email is not valid"));case 12:if(!(o.length<6)){e.next=14;break}return e.abrupt("return",alert("Please enter password with 6 or more characters"));case 14:return e.next=16,t(f,"",ee);case 16:e.next=21;break;case 18:return r=$(f,z),e.next=21,_(r,"put",ee);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(o.a,{color:"primary",variant:"contained",onClick:function(){K(b())},children:"Add User"}),Object(L.jsxs)(v.a,{fullWidth:!1,maxWidth:"md",open:F,onClose:Z,"aria-labelledby":"form-dialog-title",PaperProps:{sx:{width:400}},children:[Object(L.jsxs)(x.a,{id:"form-dialog-title",sx:{textAlign:"center",color:C.b},children:[z?"Update":"Add"," User"]}),M?Object(L.jsx)("p",{style:{textAlign:"center"},children:M}):"",Object(L.jsx)(p.a,{sx:{p:0,overflow:"hidden"},children:Object(L.jsx)("div",{className:"",children:Object(L.jsx)("form",{noValidate:!0,onSubmit:te,children:Object(L.jsxs)(m.a,{container:!0,spacing:1,direction:"column",sx:{p:3},children:[Object(L.jsx)(m.a,{item:!0,children:Object(L.jsx)(y.a,{name:"email",label:"Email",autoComplete:"off",onChange:Y,value:f.email,autoFocus:!0})}),Object(L.jsx)(m.a,{item:!0,children:Object(L.jsx)(y.a,{name:"password",label:"Password",autoComplete:"off",onChange:Y,value:f.password})}),Object(L.jsx)(m.a,{item:!0,children:Object(L.jsx)(y.a,{value:f.role,name:"role",onChange:Y,label:"Role",autoComplete:"off",type:"select",options:Q&&Q.map((function(e){return{id:e,label:Object(w.a)(e)}}))})}),Object(L.jsx)(m.a,{item:!0,xs:12,justifyContent:"center",display:"flex",children:Object(L.jsx)(k.a,{loading:n||B,className:"",type:"submit",variant:"contained",color:"primary",children:"Submit"})})]})})})})]})]})},E=n(608);t.default=function(){var e=Object(r.e)((function(e){return e.users})),t=e.list,n=e.loading,c=e.page,s=void 0===c?0:c,d=e.limit,u=void 0===d?5:d,b=e.total,g=Object(r.e)((function(e){return e.auth})).user,h=Object(r.d)(),O=function(e){e.success&&h(j(+s,+u))};Object(i.useEffect)((function(){h(j(+s,+u))}),[h]);var v=[S.e.dispatch,S.e.admin,S.e.superadmin],p={emptyMessage:"No Users found",page:s,count:b,limit:u,onPageChange:function(e,t){h(j(t-1,+u))},rowCellPadding:"normal",showRefresh:!0,columns:[{id:"name",label:"Name",emptyState:"--",renderer:function(e){var t=e.row.name;return void 0===t?"":t}},{id:"email",label:"Email"},{id:"role",label:"Role"},{id:"actions",label:"Actions",renderer:function(e){var t=e.row,n=void 0===t?{}:t,a=n._id,r=n.email,c=n.role,s=e.role;return Object(L.jsxs)(i.Fragment,{children:[v.includes(s)&&Object(L.jsx)(o.a,{variant:"contained",sx:{mr:1},onClick:function(){h(function(e){return{type:l.hb,payload:e}}({_id:a,email:r,role:c}))},children:"Update"}),g&&[S.e.admin,S.e.superadmin].includes(g.role)&&Object(L.jsx)(o.a,{variant:"contained",color:"error",onClick:Object(E.b)({message:"Are you sure you want to delete the user?",uri:"/api/users/".concat(a),afterSuccessCb:O}),children:"Delete"})]})}}]};return Object(L.jsxs)(i.Fragment,{children:[Object(L.jsx)(f.a,{loading:n,data:t,config:p,onRefetch:function(){return h(j(+s,+u))}}),Object(L.jsx)(a.a,{sx:{display:"flex",justifyContent:"flex-end"},children:Object(L.jsx)(D,{})})]})}},331:function(e,t,n){"use strict";var a=n(312),o=n(1075),i=n(1076),r=n(184),c=n(342),s=n.n(c),l=n(1074),d=n(1073),u=n(1059),j=n(85),b=n(30),f=n(14),g=n(313),h=n(29),O=n(1072),v=n(3),p=n(355),x=n.n(p),m=n(5),w=n(1071),y=n(88),C=n.n(y),I=n(336),k=n.n(I),P=n(0),S=n.n(P),L=n(22),R=n(1041),D=n(1),E=function(e){var t=e.data,n=void 0===t?[]:t,a=e.onPageChange,o=e.page,i=void 0===o?0:o,c=e.count,s=void 0===c?0:c,l=e.limit,d=void 0===l?1:l,u=Object(P.useState)(0),j=Object(f.a)(u,2),g=j[0],h=j[1];Object(P.useEffect)((function(){Array.isArray(n)&&h(n.length)}),[n]);return g<10&&s<10?null:Object(D.jsxs)(r.a,{direction:"row",sx:{display:"flex",justifyContent:"space-between",p:3},alignItems:"center",children:[s>10&&Object(D.jsxs)(b.a,{sx:{color:"#525F7F"},fontSize:13,children:["Showing ",n.length," of ",s," entries"]}),n.length!==s&&Object(D.jsx)(R.a,{count:Math.ceil(s/d),color:"primary",variant:"contained",page:i+1,size:"large",onChange:function(e,t){a&&a(e,t)}})]})},A=n(185),F=n(250);function M(){return Object(D.jsx)(A.a,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center","& > * + *":{marginLeft:2}},children:Object(D.jsx)(F.a,{})})}var z=n(335),N=n(7),U=n(20),W=["row","columns","config","handleRowClick","rowIndex","handleDelete","hasDeletePermission"],_=["columns","data","config","handleRowClick","handleDelete"],B=Object(N.a)(w.a)((function(e){var t=e.theme;return Object(m.a)({},t.breakpoints.down("xs"),{fontSize:12,padding:"0 8px"})})),T=Object(N.a)(x.a)((function(e){var t=e.theme;return Object(m.a)({},t.breakpoints.down("xs"),{fontSize:14})}));function q(e){var t=e.columns,n=void 0===t?[]:t,a=e.config,o=void 0===a?{}:a,i=o.headerCellSx,r=void 0===i?{}:i,c=o.hasDelete,s=Object(P.useMemo)((function(){return n.map((function(e,t){var n=e||{},a=n.label,o=void 0===a?"":a,i=n.id,c=void 0===i?"":i,s=n.visible,l=void 0===s||s;return(C.a.isFunction(l)?l({column:e}):l)?Object(D.jsx)(B,{padding:"normal",sx:Object(v.a)({color:"#000",fontWeight:800},r),children:o},c||t):null}))}),[n,r]);return Object(D.jsxs)(O.a,{children:[s,c&&Object(D.jsx)(B,{padding:"none",sx:{headerCellSx:r}})]})}var H=function(e){var t=e.columns,n=e.data,a=void 0===n?[]:n,o=e.config,i=void 0===o?{}:o,r=e.handleRowClick,c=e.handleDelete,s=Object(h.a)(e,_);return(a||[]).map((function(e,n){var a=i.dataKey,o=void 0===a?"":a;return o&&(e=e[o]),function(e){var t=e.row,n=void 0===t?[]:t,a=e.columns,o=void 0===a?{}:a,i=e.config,r=void 0===i?{}:i,c=e.handleRowClick,s=e.rowIndex,l=e.handleDelete,d=e.hasDeletePermission,u=Object(h.a)(e,W),j=r.hasDelete,b=void 0!==j&&j,f=r.rowCellPadding,p=void 0===f?"none":f,x=r.onRowClick,m=void 0===x?void 0:x,w=r.rowStyleCb,y=u.role,I={};w&&(I=w({row:n})||{});var k=Object(D.jsx)(B,{sx:{},padding:"none",component:"th",scope:"row",children:Object(D.jsx)(g.a,{onClick:l.bind(void 0,n._id,n),disabled:!d,children:Object(D.jsx)(T,{color:"error"})})}),P=o.map((function(e,t){var a,o=e||{},i=o.id,r=void 0===i?"":i,c=o.renderer,l=o.emptyState,d=void 0===l?"":l,u=o.valueFormatter,j=o.visible,b=void 0===j||j;return(C.a.isFunction(b)?b({column:e}):b)?(a=u&&C.a.isFunction(u)?u(n[r]):C.a.isFunction(c)?c({row:n,role:y},s)||d:n[r]||d,Object(D.jsx)(B,{padding:p||"normal",component:"th",scope:"row",children:a},r+t)):null}));return Object(D.jsxs)(O.a,{hover:!!m,onClick:function(e){e.preventDefault(),C.a.isFunction(c)&&c(n)},sx:m?Object(v.a)({cursor:"pointer"},I):{},children:[P,b&&k]},s)}(Object(v.a)({row:e,columns:t,config:i,handleRowClick:r,rowIndex:n,handleDelete:c},s))}))},J=function(e){var t=e.config,n=void 0===t?{}:t,c=e.data,h=void 0===c?[]:c,O=e.history,p=e.loading,x=void 0!==p&&p,m=e.onRefetch,w=e.isRefetching;h=h||[];var y=Object(P.useState)({}),C=Object(f.a)(y,2),I=C[0],L=C[1],R=Object(P.useState)({open:!1,config:{}}),A=Object(f.a)(R,2),F=A[0],N=A[1],W=n.columns,_=void 0===W?[]:W,B=n.onRowClick,T=n.hasOnClickUrl,J=void 0===T||T,K=n.onPageChange,V=n.page,G=n.count,Q=n.limit,X=n.size,Y=void 0===X?"medium":X,Z=n.emptyMessage,$=void 0===Z?"":Z,ee=n.onRowClickDataCallback,te=n.showRefresh,ne=void 0!==te&&te,ae=n.onDelete,oe=n.deleteMessage,ie=n.deletePermissions,re=void 0===ie?[]:ie,ce=Object(U.e)().user.role,se=void 0===ce?"":ce,le=re.indexOf(se)>-1||!1,de=S.a.useRef([]),ue=function(e){if(J&&B){var t=B(e);ee&&(e=ee(e)),O.push(t,e)}else B&&B(e)},je=function(e,t,n){n.stopPropagation();var a={title:function(){return Object(D.jsxs)(j.a,{container:!0,alignItems:"center",sx:{p:"16px 24px"},gap:1,children:[Object(D.jsx)(k.a,{color:"error"}),Object(D.jsx)(b.a,{sx:{fontSize:"1.25rem",fontWeight:550},color:"error",children:"Delete"})]})},okText:"Delete",onOk:function(){return ae(e,be)},content:function(){return Object(D.jsx)(u.a,{sx:{color:"#000"},children:oe||"Are you sure you want to delete the record?"})}};N(Object(v.a)(Object(v.a)({},F),{},{open:!0,config:a}))};function be(){N(Object(v.a)(Object(v.a)({},F),{},{open:!1}))}var fe=Object(P.useMemo)((function(){return Array.isArray(h)&&h.length?Object(D.jsxs)(P.Fragment,{children:[Object(D.jsx)(d.a,{className:"",sx:{backgroundColor:"#fafafa",borderTop:"1px solid rgba(224, 224, 224, 1)"},children:Object(D.jsx)(q,{columns:_,config:n})}),Object(D.jsx)(l.a,{children:Object(D.jsx)(H,{role:se,columns:_,data:h,config:n,handleRowClick:ue,handleDelete:je,hasDeletePermission:le},Date.now())})]}):Object(D.jsx)("tbody",{style:{height:300},children:Object(D.jsx)("tr",{children:Object(D.jsx)("td",{style:{textAlign:"center"},children:Object(D.jsx)("h4",{children:$||"No records found"})})})})}),[h,n]);return Object(P.useEffect)((function(){var e;if(null!==de&&void 0!==de&&null!==(e=de.current)&&void 0!==e&&e.table){var t=de.current.table.offsetHeight;L(Object(v.a)(Object(v.a)({},I),{},{height:t>200?t:void 0}))}}),[]),Object(D.jsxs)("div",{children:[ne&&Object(D.jsx)(r.a,{alignItems:"flex-end",children:Object(D.jsx)(g.a,{title:"Refresh",onClick:m,children:Object(D.jsx)(s.a,{className:w?"rotateIcon":void 0})})}),Object(D.jsxs)(o.a,{component:a.a,className:"",sx:{boxShadow:"0px 0px 32px #8898AA26",mb:2},children:[x?function(){var e=window.innerHeight-180,t=(I.height?I.height>e?e:I.height:e)||e;return Object(D.jsx)(j.a,{container:!0,alignItems:"center",justifyContent:"center",sx:{height:t},children:Object(D.jsx)(j.a,{item:!0,alignItems:"center",sx:{position:"relative"},children:Object(D.jsx)(M,{})})})}():Object(D.jsx)(i.a,{ref:function(e){return de.current.table=e},"aria-label":"caption table",size:Y,children:fe}),!x&&h.length>0&&Object(D.jsx)(E,{data:h,onPageChange:K,page:V,count:G,limit:Q})]}),Object(D.jsx)(z.a,{className:"enhancedTable_dialog",open:F.open,config:F.config,onClose:be})]})};t.a=Object(L.withRouter)(Object(P.memo)(J))},393:function(e,t,n){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var o=function(e,t,n){return t!==n&&(Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(e,t)),delete e[t]),e}},635:function(e,t,n){"use strict";var a=n(5),o=n(4),i=n(2),r=n(0),c=n(11),s=n(146),l=n(116),d=n(7),u=n(12),j=n(247),b=n(250),f=n(75),g=n(84);function h(e){return Object(f.a)("MuiLoadingButton",e)}var O=Object(g.a)("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),v=n(1),p=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],x=Object(d.a)(j.a,{shouldForwardProp:function(e){return function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e&&"classes"!==e}(e)||"classes"===e},name:"MuiLoadingButton",slot:"Root",overridesResolver:function(e,t){return[t.root,t.startIconLoadingStart&&Object(a.a)({},"& .".concat(O.startIconLoadingStart),t.startIconLoadingStart),t.endIconLoadingEnd&&Object(a.a)({},"& .".concat(O.endIconLoadingEnd),t.endIconLoadingEnd)]}})((function(e){var t=e.ownerState,n=e.theme;return Object(i.a)(Object(a.a)({},"& .".concat(O.startIconLoadingStart,", & .").concat(O.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0}),"center"===t.loadingPosition&&Object(a.a)({transition:n.transitions.create(["background-color","box-shadow","border-color"],{duration:n.transitions.duration.short})},"&.".concat(O.loading),{color:"transparent"}),"start"===t.loadingPosition&&t.fullWidth&&Object(a.a)({},"& .".concat(O.startIconLoadingStart,", & .").concat(O.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0,marginRight:-8}),"end"===t.loadingPosition&&t.fullWidth&&Object(a.a)({},"& .".concat(O.startIconLoadingStart,", & .").concat(O.endIconLoadingEnd),{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0,marginLeft:-8}))})),m=Object(d.a)("div",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:function(e,t){var n=e.ownerState;return[t.loadingIndicator,t["loadingIndicator".concat(Object(c.a)(n.loadingPosition))]]}})((function(e){var t=e.theme,n=e.ownerState;return Object(i.a)({position:"absolute",visibility:"visible",display:"flex"},"start"===n.loadingPosition&&("outlined"===n.variant||"contained"===n.variant)&&{left:"small"===n.size?10:14},"start"===n.loadingPosition&&"text"===n.variant&&{left:6},"center"===n.loadingPosition&&{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled},"end"===n.loadingPosition&&("outlined"===n.variant||"contained"===n.variant)&&{right:"small"===n.size?10:14},"end"===n.loadingPosition&&"text"===n.variant&&{right:6},"start"===n.loadingPosition&&n.fullWidth&&{position:"relative",left:-10},"end"===n.loadingPosition&&n.fullWidth&&{position:"relative",right:-10})})),w=r.forwardRef((function(e,t){var n=Object(u.a)({props:e,name:"MuiLoadingButton"}),a=n.children,r=n.disabled,d=void 0!==r&&r,j=n.id,f=n.loading,g=void 0!==f&&f,O=n.loadingIndicator,w=n.loadingPosition,y=void 0===w?"center":w,C=n.variant,I=void 0===C?"text":C,k=Object(o.a)(n,p),P=Object(s.a)(j),S=null!=O?O:Object(v.jsx)(b.a,{"aria-labelledby":P,color:"inherit",size:16}),L=Object(i.a)({},n,{disabled:d,loading:g,loadingIndicator:S,loadingPosition:y,variant:I}),R=function(e){var t=e.loading,n=e.loadingPosition,a=e.classes,o={root:["root",t&&"loading"],startIcon:[t&&"startIconLoading".concat(Object(c.a)(n))],endIcon:[t&&"endIconLoading".concat(Object(c.a)(n))],loadingIndicator:["loadingIndicator",t&&"loadingIndicator".concat(Object(c.a)(n))]},r=Object(l.a)(o,h,a);return Object(i.a)({},a,r)}(L),D=g?Object(v.jsx)(m,{className:R.loadingIndicator,ownerState:L,children:S}):null;return Object(v.jsxs)(x,Object(i.a)({disabled:d||g,id:P,ref:t},k,{variant:I,classes:R,ownerState:L,children:["end"===L.loadingPosition?a:D,"end"===L.loadingPosition?D:a]}))}));t.a=w}}]);
//# sourceMappingURL=20.8cbbb3ee.chunk.js.map