(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[28],{1113:function(e,t,n){"use strict";n.r(t);var a=n(993),o=n(198),i=n(0),s=n(43),r=(n(24),n(3)),c=n(27),l=n(48);const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return async n=>{try{n({type:r.w});const{success:a,data:o}=await Object(l.b)({uri:"/api/users?page=".concat(e,"&limit=").concat(t)});a||Object(c.a)(o.message,"error"),n({type:r.y,payload:o||[]})}catch(a){n({type:r.x})}}},j=()=>({type:r.U});var u=n(278),b=n(533),h=n(640),m=n(534),f=n(197),g=n(44),p=n(268),x=n(89),O=n(33),y=n(260),v=n(65),w=n(2);const C={email:"",password:"",role:"dispatch",firstName:"",lastName:""},{add:k=!1}=v.a.getUserPermissionsByDashboardId("users");var N=()=>{const{mutation:e,loading:t}=Object(p.a)("/api/users"),[n,o]=Object(i.useState)({...C}),[l,u]=Object(i.useState)({open:!1,severity:"error",message:""}),{loading:v,open:N,error:S,user:P,page:I,limit:R}=Object(s.e)((e=>e.users)),{mutation:D,loading:F}=Object(p.a)("/api/users/".concat(null===P||void 0===P?void 0:P._id)),{user:z={},allRoles:A=[]}=Object(s.e)((e=>e.auth)),{roles:E=[]}=Object(s.e)((e=>e.auth)),q=Object(s.d)(),[U,_]=Object(i.useState)();Object(i.useEffect)((()=>{if(null!==z&&void 0!==z&&z.role.equalsIgnoreCase(O.g.superadmin))_(E);else{const e=E.filter((e=>"driver"===e||"afterhours"===e||"load planner"===e||"support"===e||"dispatch"===e||"ownerOperator"===e));_(e)}o((e=>{var t;return{...e,role:A.length?null===(t=A[0])||void 0===t?void 0:t._id:""}}))}),[E,A.length]),Object(i.useEffect)((()=>{N||M()}),[N]),Object(i.useEffect)((()=>{0===+I&&N&&(M(),q(d(+I,+R)))}),[I]),Object(i.useEffect)((()=>{if(P){const{email:e,rolePermissionId:t,firstName:n,lastName:a}=P;o((o=>({...o,email:e,firstName:n,lastName:a,role:t}))),q(j())}}),[P]);const W=e=>{let{name:t,value:n}=e;o((e=>({...e,[t]:n})))},M=()=>{o({...C}),q({type:r.fb})};function T(e){let{success:t,data:n}=e;t?(M(),q(d(+I,+R)),Object(c.a)((P._id?"Updated ":"Saved ")+"Successfully")):u({open:!0,message:n.message,severity:"error"})}const L=()=>u({...l,open:!1});return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(a.a,{color:"primary",variant:"contained",onClick:()=>{q(j())},disabled:!k,children:"Add User"}),Object(w.jsxs)(b.a,{fullWidth:!1,maxWidth:"md",open:N,onClose:M,"aria-labelledby":"form-dialog-title",PaperProps:{sx:{width:400}},children:[Object(w.jsxs)(m.a,{id:"form-dialog-title",sx:{textAlign:"center",color:g.a},children:[P?"Update":"Add"," User"]}),S?Object(w.jsx)("p",{style:{textAlign:"center"},children:S}):"",Object(w.jsx)(h.a,{sx:{p:0,overflow:"hidden"},children:Object(w.jsx)("div",{className:"",children:Object(w.jsx)("form",{noValidate:!0,onSubmit:async t=>{t.preventDefault(),L();const{email:a,password:o,role:i,firstName:s}=n,{_id:r,roleName:c}=A.find((e=>e._id===i))||{};if(!v)if(P){const e=((e,t)=>{const n={},a=Object.keys(e);for(let o of a)"password"!==o&&t[o]!==e[o]&&(n[o]=e[o]),"password"===o&&e[o]&&(n[o]=e[o]);return n})(n,P);await D({...e,rolePermissionId:i,role:c},"put",T)}else{if(!(a&&o&&i&&s))return alert("All required fields should be provided");if(!Object(x.e)(a))return alert("Email is not valid");if(o.length<6)return alert("Please enter password with 6 or more characters");await e({...n,rolePermissionId:r,role:c},"",T)}},children:Object(w.jsxs)(f.a,{container:!0,spacing:2,direction:"column",sx:{p:3},children:[Object(w.jsx)(y.a,{config:l,onClose:L,inStyles:{pl:2}}),Object(w.jsx)(f.a,{item:!0,children:Object(w.jsx)(y.b,{name:"firstName",value:n.firstName||"",onChange:W,autoFocus:!0,trimValue:!0,label:"First Name",required:!0})}),Object(w.jsx)(f.a,{item:!0,children:Object(w.jsx)(y.b,{name:"lastName",value:n.lastName||"",onChange:W,label:"Last Name"})}),Object(w.jsx)(f.a,{item:!0,children:Object(w.jsx)(y.b,{name:"email",label:"Email",onChange:W,value:n.email,fullWidth:!0,required:!0})}),Object(w.jsx)(f.a,{item:!0,children:Object(w.jsx)(y.d,{name:"password",label:"Password",onChange:W,value:n.password,fullWidth:!0,required:!P})}),Object(w.jsx)(f.a,{item:!0,children:Object(w.jsx)(y.e,{onChange:W,label:"Role",name:"role",value:n.role,options:A,labelKey:"roleName",valueKey:"_id",required:!0})}),Object(w.jsx)(f.a,{item:!0,xs:12,justifyContent:"center",display:"flex",children:Object(w.jsx)(y.c,{isLoading:t||F,className:"",type:"submit",variant:"contained",color:"primary",children:"Submit"})})]})})})})]})]})},S=n(291),P=n(302);const{delete:I,edit:R}=v.a.getUserPermissionsByDashboardId("users"),D=()=>Object(w.jsx)(o.a,{sx:{display:"flex",justifyContent:"flex-end"},children:Object(w.jsx)(N,{})});t.default=()=>{const{list:e,loading:t,page:n=1,limit:o=10,total:c}=Object(s.e)((e=>e.users)),l=Object(s.d)(),j=e=>{let{success:t}=e;t&&l(d(+n,+o))};Object(i.useEffect)((()=>{l(d(+n,+o))}),[l]);const b={emptyMessage:"No Users found",page:n,count:c,limit:o,onPageChange:(e,t)=>{l(d(t,+o))},rowCellPadding:"normal",showRefresh:!0,onPageSizeChange:e=>{let{value:t}=e;l(d(1,t))},columns:[{id:"name",label:"Name",emptyState:"--",renderer:e=>{let{row:{name:t="",firstName:n,lastName:a}}=e;return t||"".concat(n||"--"," ").concat(a||"")}},{id:"email",label:"Email"},{id:"role",label:"Role",valueFormatter:P.a},{id:"actions",label:"Actions",renderer:e=>{let{row:t={}}=e;const{_id:n,email:o,role:s,rolePermissionId:c,firstName:d,lastName:u}=t;return Object(w.jsxs)(i.Fragment,{children:[Object(w.jsx)(a.a,{variant:"contained",sx:{mr:1},disabled:!R,onClick:()=>{var e;l((e={_id:n,email:o,role:s,rolePermissionId:c,firstName:d,lastName:u},{type:r.ib,payload:e}))},children:"Update"}),Object(w.jsx)(a.a,{variant:"contained",disabled:!I,color:"error",onClick:Object(S.c)({message:"Are you sure you want to delete "+o+"?",uri:"/api/users/".concat(n),afterSuccessCb:j}),children:"Delete"})]})}}]};return Object(w.jsx)(i.Fragment,{children:Object(w.jsx)(u.a,{loading:t,data:e,config:b,onRefetch:()=>l(d(+n,+o)),actions:Object(w.jsx)(D,{})})})}},268:function(e,t,n){"use strict";var a=n(0),o=n(48),i=n(89);t.a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[r,c]=Object(a.useState)(!1);return{mutation:async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"post",l=arguments.length>2?arguments[2]:void 0,d=e;s.queryParams&&(d=d+"?"+Object(i.h)(s.queryParams)),c(!0),r||(r="post");const j=(e=>{let t;switch(e){case"put":t=o.e;break;case"delete":t=o.a;break;case"patch":t=o.c;break;default:t=o.d}return t})(r.toLowerCase());if(j)return j({uri:d,callback:t,body:a,showTriggers:n}).then((e=>(l&&l({...e}),e))).catch((e=>e)).finally((()=>{c(!1)}))},loading:r}}},270:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(0),o=n(993),i=n(533),s=n(997),r=n(640),c=n(534),l=n(234),d=n(2);const j=a.forwardRef((function(e,t){return Object(d.jsx)(l.a,{direction:"up",ref:t,...e})}));function u(e){const{open:t=!1,config:n,onClose:a,preventBackdropClose:l=!1,className:u}=e,{title:b,onOk:h,okText:m="Save",content:f,onCancel:g}=n,p=function(e){l&&(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").equalsIgnoreCase("backdropclick")||a()};return Object(d.jsx)("div",{children:Object(d.jsxs)(i.a,{className:u,open:t,TransitionComponent:j,onClose:p,"aria-describedby":"alert-dialog-slide-description",children:["function"===typeof b?b({...n}):Object(d.jsx)(c.a,{sx:{fontWeight:550},children:b}),Object(d.jsx)(r.a,{children:"function"===typeof f?f({config:n}):f}),Object(d.jsxs)(s.a,{children:["function"===typeof g?g({config:n,onClose:a}):Object(d.jsx)(o.a,{variant:"outlined",onClick:p,children:"Cancel"}),"function"===typeof m?m({config:n,onOk:h}):Object(d.jsx)(o.a,{variant:"contained",color:m.equalsIgnoreCase("delete")?"error":"primary",onClick:h,children:m})]})]})})}},274:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(198),o=(n(0),n(199)),i=n(2);function s(e){return Object(i.jsx)(a.a,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center","& > * + *":{marginLeft:2}},children:Object(i.jsx)(o.a,{...e})})}},278:function(e,t,n){"use strict";var a=n(198),o=n(244),i=n(1143),s=n(1138),r=n(1144),c=n(490),l=n(299),d=n.n(l),j=n(1142),u=n(1141),b=n(994),h=n(197),m=n(87),f=n(245),g=n(1140),p=n(303),x=n.n(p),O=n(1139),y=n(259),v=n.n(y),w=n(285),C=n.n(w),k=n(0),N=n.n(k),S=n(13),P=n(1096),I=n(9),R=n(260),D=n(2);const F=Object(I.a)(P.a)((e=>{let{theme:t}=e;return{"& .MuiPaginationItem-root":{[t.breakpoints.down("md")]:{height:"1.8rem",width:"1rem"}}}})),z=Object(I.a)(c.a)((e=>{let{theme:t}=e;return{[t.breakpoints.down("sm")]:{justifyContent:"center"},display:"flex",justifyContent:"space-between",flexWrap:"wrap","& .pageSizeSelect":{width:80}}}));var A=e=>{let{data:t=[],onPageChange:n,page:a=1,count:o=0,limit:i=1,onPageSizeChange:s}=e;const[r,l]=Object(k.useState)(0);Object(k.useEffect)((()=>{Array.isArray(t)&&l(t.length)}),[t]);return o<=5?null:Object(D.jsxs)(z,{direction:"row",alignItems:"center",children:[Object(D.jsxs)(m.a,{sx:{color:"#525F7F"},fontSize:12,children:["Showing ",r," of ",o," entries"]}),Object(D.jsxs)(c.a,{direction:"row",alignItems:"center",children:[Object(D.jsx)(R.e,{name:"pageSize",label:"",value:i,options:[{id:5,label:5},{id:10,label:10},{id:20,label:20},{id:50,label:50},{id:100,label:100}],className:"pageSizeSelect",onChange:e=>{let{value:t}=e;"function"===typeof s&&s({value:t})}}),Object(D.jsx)(F,{count:Math.ceil(o/i),color:"primary",variant:"contained",page:a,size:"medium",onChange:(e,t)=>{+a!==+t&&"function"===typeof n&&n(e,+t)}})]})]})},E=n(274),q=n(270),U=n(89),_=n(272);const W=Object(I.a)(O.a)((e=>{let{theme:t}=e;return{[t.breakpoints.down("xs")]:{fontSize:12,padding:"0 8px"}}})),M=Object(I.a)(x.a)((e=>{let{theme:t}=e;return{[t.breakpoints.down("xs")]:{fontSize:14}}}));function T(e){let{columns:t=[],config:n={},role:a}=e;const{headerCellSx:o={},hasDelete:i}=n,s=Object(k.useMemo)((()=>t.map(((e,t)=>{const{label:n="",id:i="",visible:s=!0}=e||{};return(v.a.isFunction(s)?s({column:e,role:a}):s)?Object(D.jsx)(W,{padding:"normal",sx:{color:"#000",bgcolor:"#fafafa",fontWeight:800,...o},children:n},i||t):null}))),[t,o]);return Object(D.jsxs)(g.a,{children:[s,i&&Object(D.jsx)(W,{padding:"none",sx:{color:"#000",bgcolor:"#fafafa",fontWeight:800,...o}})]})}const L=e=>{let{columns:t,data:n=[],config:a={},handleRowClick:o,handleDelete:i,...s}=e;return(n||[]).map(((e,n)=>{const{dataKey:r=""}=a;return r&&(e=e[r]),(e=>{let{row:t=[],columns:n={},config:a={},handleRowClick:o,rowIndex:i,handleDelete:s,hasDeletePermission:r,...c}=e;const{hasDelete:l=!1,rowCellPadding:d="none",onRowClick:j,rowStyleCb:u}=a,{role:b}=c;let h={};u&&(h=u({row:t})||{});const m=Object(D.jsx)(W,{sx:{},padding:"none",component:"th",scope:"row",children:Object(D.jsx)(_.a,{title:"Delete",placement:"top",children:Object(D.jsx)(f.a,{onClick:s.bind(void 0,t._id,t),disabled:!r,children:Object(D.jsx)(M,{color:"error"})})})}),p=n.map(((e,n)=>{const{id:a="",renderer:o,emptyState:s="--",valueFormatter:r,visible:c=!0}=e||{};if(!(v.a.isFunction(c)?c({column:e,role:b}):c))return null;let l;return l=r&&v.a.isFunction(r)?r(t[a]):v.a.isFunction(o)?o({row:t,role:b},i)||s:v.a.get(t,a,s)||s,Object(D.jsx)(W,{padding:d||"normal",component:"th",scope:"row",children:l},a+n)}));return Object(D.jsxs)(g.a,{hover:!!j,onClick:e=>{e.preventDefault(),v.a.isFunction(o)&&o(t)},sx:j?{cursor:"pointer",...h}:{...h},children:[p,l&&m]},i)})({row:e,columns:t,config:a,handleRowClick:o,rowIndex:n,handleDelete:i,...s})}))},H=e=>{let{config:t={},data:n=[],history:l,loading:g=!1,onRefetch:p,isRefetching:x,actions:O,isPaginationLoading:y=!1}=e;n=n||[];const[w,S]=Object(k.useState)({}),[P,I]=Object(k.useState)({open:!1,config:{}}),{columns:R=[],onRowClick:F,hasOnClickUrl:z=!0,onPageChange:_,page:W,count:M,limit:H,onPageSizeChange:B,size:K="medium",emptyMessage:V="",onRowClickDataCallback:J,showRefresh:G=!1,onDelete:Q,deleteMessage:X,deletePermissions:Y=[],containerHeight:Z=""}=t,{role:$=""}=Object(U.d)().user,ee="boolean"===typeof Y?Y:Y.indexOf($)>-1||!1,te=N.a.useRef([]),ne=Array.isArray(n)&&n.length,ae=Object(k.useMemo)((()=>O&&N.a.isValidElement(O)?O:Object(D.jsx)(D.Fragment,{})),[O]),oe=e=>{if(z&&F){const t=F(e);J&&(e=J(e)),l.push(t,e)}else F&&F(e)},ie=(e,t,n)=>{n.stopPropagation();const a={title:()=>Object(D.jsxs)(h.a,{container:!0,alignItems:"center",sx:{p:"16px 24px"},gap:1,children:[Object(D.jsx)(C.a,{color:"error"}),Object(D.jsx)(m.a,{sx:{fontSize:"1.25rem",fontWeight:550},color:"error",children:"Delete"})]}),okText:"Delete",onOk:()=>Q(e,se,{row:t}),content:()=>Object(D.jsx)(b.a,{sx:{color:"#000"},children:v.a.isFunction(X)?X({row:t}):X||"Are you sure you want to delete the record?"})};I({...P,open:!0,config:a})};function se(){I({...P,open:!1})}const re=Object(k.useMemo)((()=>ne?Object(D.jsxs)(k.Fragment,{children:[Object(D.jsx)(u.a,{className:"",sx:{backgroundColor:"#fafafa",borderTop:"1px solid rgba(224, 224, 224, 1)"},children:Object(D.jsx)(T,{columns:R,config:t,role:$})}),Object(D.jsx)(j.a,{children:Object(D.jsx)(L,{role:$,columns:R,data:n,config:t,handleRowClick:oe,handleDelete:ie,hasDeletePermission:ee})})]}):Object(D.jsx)("tbody",{style:{height:300},children:Object(D.jsx)("tr",{children:Object(D.jsx)("td",{style:{textAlign:"center"},children:Object(D.jsx)("h4",{children:V||"No records found"})})})})),[n,t]);return Object(k.useEffect)((()=>{var e;if(null!==te&&void 0!==te&&null!==(e=te.current)&&void 0!==e&&e.table){const e=te.current.table.offsetHeight;S({...w,height:e>200?e:void 0})}}),[]),Object(D.jsxs)(a.a,{className:"enhanced-table",sx:{height:ne&&!g?Z||"95%":"auto"},children:[Object(D.jsxs)(c.a,{alignItems:"flex-end",justifyContent:"flex-end",direction:"row",py:1,gap:.5,children:[ae,G&&Object(D.jsx)(f.a,{title:"Refresh",onClick:p,children:Object(D.jsx)(d.a,{className:x?"rotateIcon":void 0})})]}),Object(D.jsxs)(i.a,{component:o.a,className:"",sx:{boxShadow:"0px 0px 32px #8898AA26",mb:2,height:ne&&!g?"calc(100% - 80px)":"auto",position:"relative"},children:[g?(()=>{const e=window.innerHeight-180,t=(w.height?w.height>e?e:w.height:e)||e;return Object(D.jsx)(h.a,{container:!0,alignItems:"center",justifyContent:"center",sx:{height:t},children:Object(D.jsx)(h.a,{item:!0,alignItems:"center",sx:{position:"relative"},children:Object(D.jsx)(E.a,{})})})})():Object(D.jsx)(r.a,{ref:e=>te.current.table=e,"aria-label":"caption table",size:K,stickyHeader:!0,children:re}),Object(D.jsx)(s.a,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1,position:"absolute"},open:y||x||!1,children:Object(D.jsx)(E.a,{sx:{color:"inherit"}})})]}),!g&&n.length>0&&Object(D.jsx)(A,{data:n,onPageChange:_,page:W,count:M,limit:H,onPageSizeChange:B}),Object(D.jsx)(q.a,{className:"enhancedTable_dialog",open:P.open,config:P.config,onClose:se})]})};t.a=Object(S.withRouter)(Object(k.memo)(H))}}]);
//# sourceMappingURL=28.af20e611.chunk.js.map