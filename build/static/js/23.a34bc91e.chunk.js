(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[23],{1049:function(e,t,n){"use strict";n.r(t);var r=n(185),a=n(247),i=n(0),c=n(68),o=n(21),s=n(39),l=(n(34),n(8)),u=n(23),d=n(55),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return function(){var n=Object(s.a)(Object(o.a)().mark((function n(r){var a,i,c;return Object(o.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(d.b)({uri:"/api/users?page=".concat(e+1,"&limit=").concat(t)});case 3:a=n.sent,i=a.success,c=a.data,i||Object(u.a)(c.message,"error"),r({type:l.x,payload:c||[]}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),r({type:l.w});case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},b=function(){return{type:l.T}},f=n(333),h=n(5),O=n(3),p=n(13),x=n(1064),m=n(1065),v=n(1028),g=n(85),w=n(396),y=n(121),C=n(69),k=n(342),S=n(20),D=n(31),R=n(397),P=n(1),A={email:"",password:"",role:"dispatch"},F=function(){var e=Object(k.a)("/api/users"),t=e.mutation,n=e.loading,r=Object(i.useState)(Object(O.a)({},A)),d=Object(p.a)(r,2),f=d[0],F=d[1],I=Object(c.e)((function(e){return e.users})),E=I.loading,N=I.open,U=I.error,z=I.user,M=I.page,_=I.limit,T=Object(k.a)("/api/users/".concat(null===z||void 0===z?void 0:z._id)),W=T.mutation,q=T.loading,H=Object(c.e)((function(e){return e.auth})).user,J=void 0===H?{}:H,L=Object(c.e)((function(e){return e.auth})).roles,K=void 0===L?[]:L,V=Object(c.d)(),B=Object(i.useState)(),G=Object(p.a)(B,2),Q=G[0],X=G[1];Object(i.useEffect)((function(){if(null!==J&&void 0!==J&&J.role.equalsIgnoreCase(D.e.superadmin))X(K);else{var e=K.filter((function(e){return"driver"===e||"afterhours"===e||"load planner"===e||"support"===e||"dispatch"===e}));X(e)}}),[]),Object(i.useEffect)((function(){N||Z()}),[N]),Object(i.useEffect)((function(){0===+M&&(Z(),V(j(+M,+_)))}),[M]),Object(i.useEffect)((function(){if(z){var e=z.email,t=z.role;F((function(n){return Object(O.a)(Object(O.a)({},n),{},{email:e,role:t})})),V(b())}}),[z]);var Y=function(e){var t=e.target,n=t.name,r=t.value;F((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(h.a)({},n,r))}))},Z=function(){F(Object(O.a)({},A)),V({type:l.eb})},$=function(e,t){for(var n={},r=0,a=Object.keys(e);r<a.length;r++){var i=a[r];"password"!==i&&t[i]!==e[i]&&(n[i]=e[i]),"password"===i&&e[i]&&(n[i]=e[i])}return n};function ee(e){var t=e.success,n=e.data;t?(Z(),V(j(+M,+_)),Object(u.a)((z._id?"Updated ":"Saved ")+"Successfully")):Object(u.a)(n.message,"error")}var te=function(){var e=Object(s.a)(Object(o.a)().mark((function e(n){var r,a,i,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),E){e.next=21;break}if(z){e.next=18;break}if(r=f.email,a=f.password,i=f.role,r&&a&&i){e.next=8;break}return e.abrupt("return",alert("All fields are required"));case 8:if(Object(S.e)(r)){e.next=12;break}return e.abrupt("return",alert("Email is not valid"));case 12:if(!(a.length<6)){e.next=14;break}return e.abrupt("return",alert("Please enter password with 6 or more characters"));case 14:return e.next=16,t(f,"",ee);case 16:e.next=21;break;case 18:return c=$(f,z),e.next=21,W(c,"put",ee);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(a.a,{color:"primary",variant:"contained",onClick:function(){V(b())},children:"Add User"}),Object(P.jsxs)(x.a,{fullWidth:!1,maxWidth:"md",open:N,onClose:Z,"aria-labelledby":"form-dialog-title",PaperProps:{sx:{width:400}},children:[Object(P.jsxs)(v.a,{id:"form-dialog-title",sx:{textAlign:"center",color:C.b},children:[z?"Update":"Add"," User"]}),U?Object(P.jsx)("p",{style:{textAlign:"center"},children:U}):"",Object(P.jsx)(m.a,{sx:{p:0,overflow:"hidden"},children:Object(P.jsx)("div",{className:"",children:Object(P.jsx)("form",{noValidate:!0,onSubmit:te,children:Object(P.jsxs)(g.a,{container:!0,spacing:1,direction:"column",sx:{p:3},children:[Object(P.jsx)(g.a,{item:!0,children:Object(P.jsx)(y.a,{name:"email",label:"Email",autoComplete:"off",onChange:Y,value:f.email,autoFocus:!0})}),Object(P.jsx)(g.a,{item:!0,children:Object(P.jsx)(y.a,{name:"password",label:"Password",autoComplete:"off",onChange:Y,value:f.password})}),Object(P.jsx)(g.a,{item:!0,children:Object(P.jsx)(y.a,{value:f.role,name:"role",onChange:Y,label:"Role",autoComplete:"off",type:"select",options:Q&&Q.map((function(e){return{id:e,label:Object(w.a)(e)}}))})}),Object(P.jsx)(g.a,{item:!0,xs:12,justifyContent:"center",display:"flex",children:Object(P.jsx)(R.b,{isLoading:n||q,className:"",type:"submit",variant:"contained",color:"primary",children:"Submit"})})]})})})})]})]})},I=n(607);t.default=function(){var e=Object(c.e)((function(e){return e.users})),t=e.list,n=e.loading,o=e.page,s=void 0===o?0:o,u=e.limit,d=void 0===u?5:u,b=e.total,h=Object(c.e)((function(e){return e.auth})).user,O=Object(c.d)(),p=function(e){e.success&&O(j(+s,+d))};Object(i.useEffect)((function(){O(j(+s,+d))}),[O]);var x=[D.e.dispatch,D.e.admin,D.e.superadmin],m={emptyMessage:"No Users found",page:s,count:b,limit:d,onPageChange:function(e,t){O(j(t-1,+d))},rowCellPadding:"normal",showRefresh:!0,columns:[{id:"name",label:"Name",emptyState:"--",renderer:function(e){var t=e.row.name;return void 0===t?"":t}},{id:"email",label:"Email"},{id:"role",label:"Role"},{id:"actions",label:"Actions",renderer:function(e){var t=e.row,n=void 0===t?{}:t,r=n._id,c=n.email,o=n.role,s=e.role;return Object(P.jsxs)(i.Fragment,{children:[x.includes(s)&&Object(P.jsx)(a.a,{variant:"contained",sx:{mr:1},onClick:function(){O(function(e){return{type:l.hb,payload:e}}({_id:r,email:c,role:o}))},children:"Update"}),h&&[D.e.admin,D.e.superadmin].includes(h.role)&&Object(P.jsx)(a.a,{variant:"contained",color:"error",onClick:Object(I.b)({message:"Are you sure you want to delete the user?",uri:"/api/users/".concat(r),afterSuccessCb:p}),children:"Delete"})]})}}]};return Object(P.jsxs)(i.Fragment,{children:[Object(P.jsx)(f.a,{loading:n,data:t,config:m,onRefetch:function(){return O(j(+s,+d))}}),Object(P.jsx)(r.a,{sx:{display:"flex",justifyContent:"flex-end"},children:Object(P.jsx)(F,{})})]})}},333:function(e,t,n){"use strict";var r=n(314),a=n(1075),i=n(1076),c=n(184),o=n(344),s=n.n(o),l=n(1074),u=n(1073),d=n(1059),j=n(85),b=n(30),f=n(13),h=n(315),O=n(29),p=n(1072),x=n(3),m=n(357),v=n.n(m),g=n(5),w=n(1071),y=n(88),C=n.n(y),k=n(338),S=n.n(k),D=n(0),R=n.n(D),P=n(22),A=n(1041),F=n(1),I=function(e){var t=e.data,n=void 0===t?[]:t,r=e.onPageChange,a=e.page,i=void 0===a?0:a,o=e.count,s=void 0===o?0:o,l=e.limit,u=void 0===l?1:l,d=Object(D.useState)(0),j=Object(f.a)(d,2),h=j[0],O=j[1];Object(D.useEffect)((function(){Array.isArray(n)&&O(n.length)}),[n]);return h<10&&s<10?null:Object(F.jsxs)(c.a,{direction:"row",sx:{display:"flex",justifyContent:"space-between",p:3},alignItems:"center",children:[s>10&&Object(F.jsxs)(b.a,{sx:{color:"#525F7F"},fontSize:13,children:["Showing ",n.length," of ",s," entries"]}),n.length!==s&&Object(F.jsx)(A.a,{count:Math.ceil(s/u),color:"primary",variant:"contained",page:i+1,size:"large",onChange:function(e,t){r&&r(e,t)}})]})},E=n(185),N=n(250);function U(){return Object(F.jsx)(E.a,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center","& > * + *":{marginLeft:2}},children:Object(F.jsx)(N.a,{})})}var z=n(337),M=n(7),_=n(20),T=["row","columns","config","handleRowClick","rowIndex","handleDelete","hasDeletePermission"],W=["columns","data","config","handleRowClick","handleDelete"],q=Object(M.a)(w.a)((function(e){var t=e.theme;return Object(g.a)({},t.breakpoints.down("xs"),{fontSize:12,padding:"0 8px"})})),H=Object(M.a)(v.a)((function(e){var t=e.theme;return Object(g.a)({},t.breakpoints.down("xs"),{fontSize:14})}));function J(e){var t=e.columns,n=void 0===t?[]:t,r=e.config,a=void 0===r?{}:r,i=a.headerCellSx,c=void 0===i?{}:i,o=a.hasDelete,s=Object(D.useMemo)((function(){return n.map((function(e,t){var n=e||{},r=n.label,a=void 0===r?"":r,i=n.id,o=void 0===i?"":i,s=n.visible,l=void 0===s||s;return(C.a.isFunction(l)?l({column:e}):l)?Object(F.jsx)(q,{padding:"normal",sx:Object(x.a)({color:"#000",fontWeight:800},c),children:a},o||t):null}))}),[n,c]);return Object(F.jsxs)(p.a,{children:[s,o&&Object(F.jsx)(q,{padding:"none",sx:{headerCellSx:c}})]})}var L=function(e){var t=e.columns,n=e.data,r=void 0===n?[]:n,a=e.config,i=void 0===a?{}:a,c=e.handleRowClick,o=e.handleDelete,s=Object(O.a)(e,W);return(r||[]).map((function(e,n){var r=i.dataKey,a=void 0===r?"":r;return a&&(e=e[a]),function(e){var t=e.row,n=void 0===t?[]:t,r=e.columns,a=void 0===r?{}:r,i=e.config,c=void 0===i?{}:i,o=e.handleRowClick,s=e.rowIndex,l=e.handleDelete,u=e.hasDeletePermission,d=Object(O.a)(e,T),j=c.hasDelete,b=void 0!==j&&j,f=c.rowCellPadding,m=void 0===f?"none":f,v=c.onRowClick,g=void 0===v?void 0:v,w=c.rowStyleCb,y=d.role,k={};w&&(k=w({row:n})||{});var S=Object(F.jsx)(q,{sx:{},padding:"none",component:"th",scope:"row",children:Object(F.jsx)(h.a,{onClick:l.bind(void 0,n._id,n),disabled:!u,children:Object(F.jsx)(H,{color:"error"})})}),D=a.map((function(e,t){var r,a=e||{},i=a.id,c=void 0===i?"":i,o=a.renderer,l=a.emptyState,u=void 0===l?"":l,d=a.valueFormatter,j=a.visible,b=void 0===j||j;return(C.a.isFunction(b)?b({column:e}):b)?(r=d&&C.a.isFunction(d)?d(n[c]):C.a.isFunction(o)?o({row:n,role:y},s)||u:n[c]||u,Object(F.jsx)(q,{padding:m||"normal",component:"th",scope:"row",children:r},c+t)):null}));return Object(F.jsxs)(p.a,{hover:!!g,onClick:function(e){e.preventDefault(),C.a.isFunction(o)&&o(n)},sx:g?Object(x.a)({cursor:"pointer"},k):{},children:[D,b&&S]},s)}(Object(x.a)({row:e,columns:t,config:i,handleRowClick:c,rowIndex:n,handleDelete:o},s))}))},K=function(e){var t=e.config,n=void 0===t?{}:t,o=e.data,O=void 0===o?[]:o,p=e.history,m=e.loading,v=void 0!==m&&m,g=e.onRefetch,w=e.isRefetching;O=O||[];var y=Object(D.useState)({}),C=Object(f.a)(y,2),k=C[0],P=C[1],A=Object(D.useState)({open:!1,config:{}}),E=Object(f.a)(A,2),N=E[0],M=E[1],T=n.columns,W=void 0===T?[]:T,q=n.onRowClick,H=n.hasOnClickUrl,K=void 0===H||H,V=n.onPageChange,B=n.page,G=n.count,Q=n.limit,X=n.size,Y=void 0===X?"medium":X,Z=n.emptyMessage,$=void 0===Z?"":Z,ee=n.onRowClickDataCallback,te=n.showRefresh,ne=void 0!==te&&te,re=n.onDelete,ae=n.deleteMessage,ie=n.deletePermissions,ce=void 0===ie?[]:ie,oe=Object(_.d)().user.role,se=void 0===oe?"":oe,le=ce.indexOf(se)>-1||!1,ue=R.a.useRef([]),de=function(e){if(K&&q){var t=q(e);ee&&(e=ee(e)),p.push(t,e)}else q&&q(e)},je=function(e,t,n){n.stopPropagation();var r={title:function(){return Object(F.jsxs)(j.a,{container:!0,alignItems:"center",sx:{p:"16px 24px"},gap:1,children:[Object(F.jsx)(S.a,{color:"error"}),Object(F.jsx)(b.a,{sx:{fontSize:"1.25rem",fontWeight:550},color:"error",children:"Delete"})]})},okText:"Delete",onOk:function(){return re(e,be)},content:function(){return Object(F.jsx)(d.a,{sx:{color:"#000"},children:ae||"Are you sure you want to delete the record?"})}};M(Object(x.a)(Object(x.a)({},N),{},{open:!0,config:r}))};function be(){M(Object(x.a)(Object(x.a)({},N),{},{open:!1}))}var fe=Object(D.useMemo)((function(){return Array.isArray(O)&&O.length?Object(F.jsxs)(D.Fragment,{children:[Object(F.jsx)(u.a,{className:"",sx:{backgroundColor:"#fafafa",borderTop:"1px solid rgba(224, 224, 224, 1)"},children:Object(F.jsx)(J,{columns:W,config:n})}),Object(F.jsx)(l.a,{children:Object(F.jsx)(L,{role:se,columns:W,data:O,config:n,handleRowClick:de,handleDelete:je,hasDeletePermission:le},Date.now())})]}):Object(F.jsx)("tbody",{style:{height:300},children:Object(F.jsx)("tr",{children:Object(F.jsx)("td",{style:{textAlign:"center"},children:Object(F.jsx)("h4",{children:$||"No records found"})})})})}),[O,n]);return Object(D.useEffect)((function(){var e;if(null!==ue&&void 0!==ue&&null!==(e=ue.current)&&void 0!==e&&e.table){var t=ue.current.table.offsetHeight;P(Object(x.a)(Object(x.a)({},k),{},{height:t>200?t:void 0}))}}),[]),Object(F.jsxs)("div",{children:[ne&&Object(F.jsx)(c.a,{alignItems:"flex-end",children:Object(F.jsx)(h.a,{title:"Refresh",onClick:g,children:Object(F.jsx)(s.a,{className:w?"rotateIcon":void 0})})}),Object(F.jsxs)(a.a,{component:r.a,className:"",sx:{boxShadow:"0px 0px 32px #8898AA26",mb:2},children:[v?function(){var e=window.innerHeight-180,t=(k.height?k.height>e?e:k.height:e)||e;return Object(F.jsx)(j.a,{container:!0,alignItems:"center",justifyContent:"center",sx:{height:t},children:Object(F.jsx)(j.a,{item:!0,alignItems:"center",sx:{position:"relative"},children:Object(F.jsx)(U,{})})})}():Object(F.jsx)(i.a,{ref:function(e){return ue.current.table=e},"aria-label":"caption table",size:Y,children:fe}),!v&&O.length>0&&Object(F.jsx)(I,{data:O,onPageChange:V,page:B,count:G,limit:Q})]}),Object(F.jsx)(z.a,{className:"enhancedTable_dialog",open:N.open,config:N.config,onClose:be})]})};t.a=Object(P.withRouter)(Object(D.memo)(K))},396:function(e,t,n){"use strict";function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var a=function(e,t,n){return t!==n&&(Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(e,t)),delete e[t]),e}}}]);
//# sourceMappingURL=23.a34bc91e.chunk.js.map