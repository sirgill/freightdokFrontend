{"ast":null,"code":"var _jsxFileName = \"/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdokFrontend/client/src/components/users/UserForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles, withStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\"\n  },\n  select: {\n    \"&:before\": {\n      borderColor: \"#1891FC\"\n    },\n    width: 195,\n    padding: 0,\n    margin: 0\n  }\n}));\nconst CssTextField = withStyles({\n  root: {\n    '& label.Mui-focused': {\n      color: '#1891FC'\n    },\n    '& .MuiInput-underline:after': {\n      borderBottomColor: '#1891FC'\n    },\n    '& .MuiInput-underline:before': {\n      borderColor: '#1891FC'\n    },\n    '& .MuiOutlinedInput-root': {\n      '& fieldset': {\n        borderColor: '#1891FC'\n      },\n      '&:hover fieldset': {\n        borderColor: '#1891FC'\n      },\n      '&.Mui-focused fieldset': {\n        borderColor: '#1891FC'\n      }\n    }\n  }\n})(TextField);\nconst initialState = {\n  email: '',\n  password: '',\n  role: ''\n};\n\nconst UserForm = () => {\n  _s();\n\n  const classes = useStyles();\n  const [form, setForm] = useState({ ...initialState\n  });\n  const {\n    loading,\n    open,\n    error,\n    user,\n    page,\n    limit\n  } = useSelector(state => state.users);\n  const {\n    user: auth\n  } = useSelector(state => state.auth);\n  const {\n    roles\n  } = useSelector(state => state.auth);\n  const dispatch = useDispatch();\n  const [userRoles, setUserRoles] = useState();\n  useEffect(() => {\n    setUserRoles(roles);\n\n    if (auth.role === 'dispatch') {\n      const newRoles = roles.filter(item => item === 'driver' || item === 'afterhours' || item === 'load planner' || item === 'support');\n      setUserRoles(newRoles);\n    }\n  }, []);\n  useEffect(() => {\n    if (!open) handleClose();\n  }, [open]);\n  useEffect(() => {\n    if (+page === 0) {\n      handleClose();\n      dispatch(fetchUsers(+page, +limit));\n    }\n  }, [page]);\n  useEffect(() => {\n    if (user) {\n      const {\n        email,\n        role\n      } = user;\n      setForm(f => ({ ...f,\n        email,\n        role\n      }));\n      dispatch(openModal());\n    }\n  }, [user]);\n\n  const handleChange = ({\n    target\n  }) => {\n    const {\n      name,\n      value\n    } = target;\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const handleClose = () => {\n    setForm({ ...initialState\n    });\n    dispatch(resetUserSelected());\n  };\n\n  const handleClickOpen = () => {\n    dispatch(openModal());\n  };\n\n  const getDiff = (local, actual) => {\n    const diffWithVal = {};\n    const localKeys = Object.keys(local);\n\n    for (let key of localKeys) {\n      if (key !== 'password' && actual[key] !== local[key]) diffWithVal[key] = local[key];\n      if (key === 'password' && local[key]) diffWithVal[key] = local[key];\n    }\n\n    return diffWithVal;\n  };\n\n  const onSubmit = () => {\n    if (!loading) {\n      if (!user) {\n        const {\n          email,\n          password,\n          role\n        } = form;\n        if (!email || !password || !role) return alert('All fields are required');\n        dispatch(registerUser(form));\n      } else {\n        const {\n          _id\n        } = user;\n        const dataToUpdate = getDiff(form, user);\n        dispatch(updateUser(dataToUpdate, _id));\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [auth && ['user'].indexOf(auth.role) > -1 || /*#__PURE__*/_jsxDEV(Fab, {\n      color: \"primary\",\n      onClick: handleClickOpen,\n      style: {\n        marginBottom: '20%'\n      },\n      children: /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 57\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      fullWidth: true,\n      maxWidth: \"sm\",\n      open: open,\n      onClose: handleClose,\n      \"aria-labelledby\": \"form-dialog-title\",\n      children: [error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          textAlign: 'center'\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 23\n      }, this) : '', /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            className: classes.form,\n            children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n              id: \"form-dialog-title\",\n              children: [user ? 'Update' : 'Add', \" User\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: /*#__PURE__*/_jsxDEV(CssTextField, {\n                  id: \"outlined-basic\",\n                  type: \"email\",\n                  className: \"form-control\",\n                  name: \"email\",\n                  label: \"Email\",\n                  autoComplete: 'off',\n                  onChange: handleChange,\n                  value: form.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: /*#__PURE__*/_jsxDEV(CssTextField, {\n                  id: \"outlined-basic-p\",\n                  type: \"password\",\n                  className: \"form-control\",\n                  name: \"password\",\n                  label: \"Password\",\n                  autoComplete: 'off',\n                  onChange: handleChange,\n                  value: form.password\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                  id: \"userRoleLabel\",\n                  children: \"Role\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Select, {\n                  style: {\n                    width: '100%'\n                  },\n                  labelId: \"userRoleLabel\",\n                  id: \"userRoleLabel\",\n                  value: form.role,\n                  name: \"role\",\n                  onChange: handleChange,\n                  className: classes.select,\n                  children: userRoles && userRoles.map(role => /*#__PURE__*/_jsxDEV(MenuItem, {\n                    value: role,\n                    children: capitalizeFirstLetter(role)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 77\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 182,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 1,\n              style: {\n                marginTop: \"20px\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 4\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 4,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"\",\n                  type: \"button\",\n                  variant: \"outlined\",\n                  color: \"primary\",\n                  onClick: onSubmit,\n                  children: \"Submit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 4\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(UserForm, \"YKHBUTk7iwMbJ9PdFxco7IikpGY=\", false, function () {\n  return [useStyles, useSelector, useSelector, useSelector, useDispatch];\n});\n\n_c = UserForm;\nexport default UserForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserForm\");","map":{"version":3,"sources":["/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdokFrontend/client/src/components/users/UserForm.js"],"names":["React","useState","useEffect","Fab","AddIcon","Dialog","DialogContent","DialogTitle","TextField","Grid","Button","Select","InputLabel","MenuItem","makeStyles","withStyles","useDispatch","useSelector","registerUser","resetUserSelected","updateUser","fetchUsers","openModal","capitalizeFirstLetter","useStyles","theme","form","display","flexDirection","margin","width","select","borderColor","padding","CssTextField","root","color","borderBottomColor","initialState","email","password","role","UserForm","classes","setForm","loading","open","error","user","page","limit","state","users","auth","roles","dispatch","userRoles","setUserRoles","newRoles","filter","item","handleClose","f","handleChange","target","name","value","handleClickOpen","getDiff","local","actual","diffWithVal","localKeys","Object","keys","key","onSubmit","alert","_id","dataToUpdate","indexOf","marginBottom","textAlign","map","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles,withStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\",\n  },\n  select: {\n    \"&:before\": {\n      borderColor: \"#1891FC\"\n    },\n    width: 195,\n    padding: 0,\n    margin: 0\n  }\n}));\n\nconst CssTextField = withStyles({\n    root: {\n      '& label.Mui-focused': {\n        color: '#1891FC',\n      },\n      '& .MuiInput-underline:after': {\n        borderBottomColor: '#1891FC',\n      },\n      '& .MuiInput-underline:before': {\n        borderColor: '#1891FC'\n      },\n      '& .MuiOutlinedInput-root': {\n        '& fieldset': {\n          borderColor: '#1891FC',\n        },\n        '&:hover fieldset': {\n          borderColor: '#1891FC',\n        },\n        '&.Mui-focused fieldset': {\n          borderColor: '#1891FC',\n        },\n      },\n    },\n  })(TextField);\n\nconst initialState = {\n    email: '', \n    password: '', \n    role: ''\n};\n\nconst UserForm = () => {\n\n    const classes = useStyles();\n    const [form, setForm] = useState({ ...initialState });\n    const { loading, open, error, user, page, limit } = useSelector(state => state.users);\n    const { user: auth } = useSelector(state => state.auth);\n    const { roles } = useSelector(state => state.auth);\n    const dispatch = useDispatch();\n    const [userRoles, setUserRoles] = useState();\n\n    useEffect(() => {\n        setUserRoles(roles);\n        \n        if (auth.role === 'dispatch') {\n            const newRoles = roles.filter(item => (item === 'driver' || item === 'afterhours' || item === 'load planner' || item === 'support'));\n            setUserRoles(newRoles);\n        }\n    }, [])\n\n    useEffect(() => {\n        if (!open) handleClose();\n    }, [open])\n\n    useEffect(() => {\n        if (+page === 0) {\n            handleClose();\n            dispatch(fetchUsers(+page, +limit));\n        }\n    }, [page])\n\n    useEffect(() => {\n        if (user) {\n            const { email, role } = user;\n            setForm(f => ({ ...f, email, role }));\n            dispatch(openModal());\n        }\n    }, [user]);\n\n    const handleChange = ({ target }) => {\n        const { name, value } = target;\n        setForm(f => ({ ...f, [name]: value }));\n    }\n    const handleClose = () => {\n        setForm({ ...initialState });\n        dispatch(resetUserSelected());\n    }\n\n    const handleClickOpen = () => {dispatch(openModal())}\n\n    const getDiff = (local, actual) => {\n        const diffWithVal = {};\n        const localKeys = Object.keys(local);\n        for (let key of localKeys) {\n            if (key !== 'password' && actual[key] !== local[key])\n                diffWithVal[key] = local[key];\n            if (key === 'password' && local[key])\n                diffWithVal[key] = local[key];   \n        }\n        return diffWithVal;\n    }\n\n    const onSubmit = () => {\n        if (!loading) {\n            if (!user) {\n                const { email, password, role } = form;\n                if (!email || !password || !role)\n                    return alert('All fields are required');\n                dispatch(registerUser(form));\n            } else {\n                const { _id } = user;\n                const dataToUpdate = getDiff(form, user);\n                dispatch(updateUser(dataToUpdate, _id));\n            }\n        }\n    }\n\n    return <>\n        { (auth && ['user'].indexOf(auth.role) > -1) || <Fab color=\"primary\" onClick={handleClickOpen} style={{marginBottom: '20%'}}>\n            <AddIcon />\n        </Fab> }\n        <Dialog fullWidth={true} maxWidth={\"sm\"} open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\n            \n            { error ? <p style={{textAlign:'center'}}>{error}</p> : '' }\n            <DialogContent>\n                <div className=\"\">\n                    <form className={classes.form}>\n                        <DialogTitle id=\"form-dialog-title\">{ user ? 'Update' : 'Add' } User</DialogTitle>\n                        <div>\n                            <div className=\"form-group\">\n                                <CssTextField\n                                    id=\"outlined-basic\"\n                                    type=\"email\"\n                                    className=\"form-control\"\n                                    name=\"email\"\n                                    label=\"Email\"\n                                    autoComplete={'off'}\n                                    onChange={handleChange}\n                                    value={form.email}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <CssTextField\n                                    id=\"outlined-basic-p\"\n                                    type=\"password\"\n                                    className=\"form-control\"\n                                    name=\"password\"\n                                    label=\"Password\"\n                                    autoComplete={'off'}\n                                    onChange={handleChange}\n                                    value={form.password}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <InputLabel id=\"userRoleLabel\">Role</InputLabel>\n                                <Select\n                                    style={{width: '100%'}}\n                                    labelId=\"userRoleLabel\"\n                                    id=\"userRoleLabel\"\n                                    value={form.role}\n                                    name=\"role\"\n                                    onChange={handleChange}\n                                    className={classes.select}\n                                >\n                                    {\n                                        userRoles && userRoles.map(role => (<MenuItem value={role}>{capitalizeFirstLetter(role)}</MenuItem>))\n                                    }\n                                </Select>\n                            </div>\n                        </div>\n                        <Grid container spacing={1} style={{ marginTop: \"20px\" }}>\n                            <Grid item xs={4}></Grid>\n                            <Grid item xs={4}>\n                                <Button className=\"\" type=\"button\" variant=\"outlined\" color=\"primary\"  onClick={onSubmit}>\n                                    Submit\n                                </Button>\n                            </Grid>\n                            <Grid item xs={4}></Grid>\n                        </Grid>\n                    </form>\n                </div>\n            </DialogContent>\n        </Dialog>\n    </>\n}\n\nexport default UserForm;"]},"metadata":{},"sourceType":"module"}