{"ast":null,"code":"var _jsxFileName = \"/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdok/client/src/components/invoices/InvoicesWizard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Modal, Step } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport { Button } from '@material-ui/core';\nimport IconButton from '@material-ui/core/IconButton';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport { useDispatch } from 'react-redux';\nimport { deleteLoadDocument, uploadLoadDocument, generateInvoice, mergeDocuments, resetInvoiceGenerated } from '../../actions/load';\nimport { Page, Text, View, Document, StyleSheet, PDFDownloadLink, pdf } from '@react-pdf/renderer';\nimport { saveAs } from \"file-saver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst styles = StyleSheet.create({\n  page: {\n    flexDirection: 'column',\n    backgroundColor: '#E4E4E4'\n  },\n  section: {\n    margin: 5,\n    padding: 5,\n    textAlign: 'center'\n  }\n});\n\nconst generatePDFDocument = async ({\n  from,\n  to,\n  load_number,\n  broker,\n  rate\n}) => {\n  return new Promise(async resolve => {\n    const blob = await pdf( /*#__PURE__*/_jsxDEV(Document, {\n      children: /*#__PURE__*/_jsxDEV(Page, {\n        size: \"A4\",\n        style: styles.page,\n        children: [/*#__PURE__*/_jsxDEV(View, {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"From\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 33,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: [\"Name: \", from.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 34,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: [\"Company Name: \", from.company_name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 35,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: [\"Email: \", from.email]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 36,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(View, {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"To\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: [\"Company Name: \", to.company_name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: [\"Email: \", to.email]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(View, {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"Load\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: load_number\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(View, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(View, {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"Broker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: broker ? broker : '--'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(View, {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"Rate\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: rate ? rate : '--'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 13\n    }, this)).toBlob();\n    resolve(blob);\n  });\n};\n\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    position: 'absolute',\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3)\n  },\n  root: {\n    flexGrow: 1,\n    flexDirection: \"row\",\n    textAlign: \"center\"\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  resizeDialog: {\n    fontSize: 14\n  },\n  modalBody: {\n    width: '100%',\n    minHeight: '324px'\n  },\n  modalFooter: {\n    width: '100%'\n  },\n  btn_container: {\n    textAlign: 'end'\n  }\n}));\n\nconst getModalStyle = () => {\n  return {\n    top: '50%',\n    left: '50%',\n    width: '400px',\n    transform: 'translate(-50%, -50%)',\n    overflowY: 'auto',\n    height: '400px'\n  };\n};\n\nconst formInitialState = {\n  from: {\n    name: '',\n    company_name: '',\n    email: ''\n  },\n  to: {\n    company_name: '',\n    email: ''\n  }\n};\nexport default function InvoiceWizard({\n  load_selected,\n  handleOnClose,\n  deleteDoc,\n  updateDoc,\n  invoiceGenerated\n}) {\n  _s();\n\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const [modalStyle] = useState(getModalStyle);\n  const [form, setForm] = useState(formInitialState);\n  const [step, setStep] = useState(1);\n  const rcfr = useRef();\n  const pdfr = useRef();\n\n  const handleSubmit = async (event = null) => {\n    if (event) event.preventDefault();\n    dispatch(generateInvoice(load_selected._id, form));\n    const blob = await generatePDFDocument({\n      from: form.from,\n      to: form.to,\n      load_number: load_selected.loadNumber,\n      broker: load_selected.brokerage,\n      rate: load_selected.rate\n    });\n    var reader = new FileReader();\n    reader.readAsDataURL(blob);\n\n    reader.onloadend = async () => {\n      var base64data = reader.result;\n      const headers = {\n        responseType: 'arraybuffer',\n        headers: {\n          Accept: 'application/pdf'\n        }\n      };\n      const dataToSend = {\n        invoice: base64data,\n        docs: []\n      };\n\n      if (load_selected.rateConfirmation && load_selected.rateConfirmation.length > 0) {\n        console.log('Rate Confirmation :', load_selected.rateConfirmation[0]);\n        dataToSend.docs.push(load_selected.rateConfirmation[0].name);\n      }\n\n      if (load_selected.proofDelivery && load_selected.proofDelivery.length > 0) {\n        console.log('Proof Delivery :', load_selected.proofDelivery[0]);\n        dataToSend.docs.push(load_selected.proofDelivery[0].name);\n      }\n\n      dispatch(mergeDocuments(dataToSend, headers));\n    };\n  };\n\n  useEffect(() => {\n    dispatch(resetInvoiceGenerated());\n  }, []);\n  useEffect(() => {\n    console.log('Updated :', load_selected);\n\n    if (invoiceGenerated) {\n      const file = new Blob([invoiceGenerated], {\n        type: \"application/pdf\"\n      });\n      saveAs(file, 'Invoice');\n      dispatch(resetInvoiceGenerated());\n      handleOnClose();\n    }\n  }, [invoiceGenerated, load_selected]);\n\n  const handleOnChange = (event, key) => {\n    const {\n      name,\n      value\n    } = event.target;\n    setForm(form => ({ ...form,\n      [key]: { ...form[key],\n        [name]: value\n      }\n    }));\n  };\n\n  const changeStep = move => {\n    const new_step = move === 'next' ? step + 1 : step - 1;\n    let error = false;\n    let errorMsg = '';\n\n    if ((step === 1 || step === 2) && (form.from.email && !validateEmail(form.from.email) || form.to.email && !validateEmail(form.to.email))) {\n      error = true;\n      errorMsg = 'Invalid Email';\n    }\n\n    if (step === 1 && (!form.from.name || !form.from.company_name || !form.from.email)) {\n      error = true;\n      errorMsg = 'Please fill the form to continue.';\n    }\n\n    if (step === 2 && (!form.to.company_name || !form.to.email)) {\n      error = true;\n      errorMsg = 'Please fill the form to continue.';\n    }\n\n    if (move === 'next' && error) alert(errorMsg);else setStep(new_step);\n  };\n\n  const validateEmail = email => {\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  };\n\n  const deleteDocument = doc_type => {\n    dispatch(deleteLoadDocument(load_selected._id, doc_type, '')); // remove timer and get actual state of invoice to show the upload button instead of delete button on delete success\n\n    setTimeout(() => {\n      deleteDoc(doc_type);\n    }, 2000);\n  };\n\n  const uploadDocument = (doc_type, documents) => {\n    const file_data = [];\n\n    for (let file of documents) {\n      const {\n        filename\n      } = file;\n      file_data.push({\n        name: filename,\n        date: Date.now()\n      });\n    }\n\n    dispatch(uploadLoadDocument(load_selected._id, doc_type, documents));\n    setTimeout(() => {\n      updateDoc(doc_type, file_data);\n    }, 2000);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    open: load_selected ? true : false,\n    onClose: () => {\n      handleOnClose();\n      setForm(formInitialState);\n      setStep(1);\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: modalStyle,\n      className: classes.paper,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 2,\n          className: classes.root,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.modalBody,\n            children: [step !== 3 ? /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: step === 1 ? 'From' : 'To'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 40\n            }, this) : '', step === 1 ? /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: /*#__PURE__*/_jsxDEV(TextField, {\n                    id: \"outlined-basic\",\n                    variant: \"outlined\",\n                    label: \"Name\",\n                    name: \"name\",\n                    value: form[step === 1 ? 'from' : 'to'].name,\n                    onChange: event => handleOnChange(event, step === 1 ? 'from' : 'to')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 256,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 40\n            }, this) : '', step < 3 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: /*#__PURE__*/_jsxDEV(Grid, {\n                  container: true,\n                  spacing: 2,\n                  children: [/*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: /*#__PURE__*/_jsxDEV(TextField, {\n                      id: \"outlined-basic\",\n                      variant: \"outlined\",\n                      label: \"Company Name\",\n                      name: \"company_name\",\n                      value: form[step === 1 ? 'from' : 'to'].company_name,\n                      onChange: event => handleOnChange(event, step === 1 ? 'from' : 'to')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 271,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 270,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 33\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 40\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: /*#__PURE__*/_jsxDEV(Grid, {\n                  container: true,\n                  spacing: 2,\n                  children: [/*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 284,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 6,\n                    children: /*#__PURE__*/_jsxDEV(TextField, {\n                      id: \"outlined-basic\",\n                      variant: \"outlined\",\n                      label: \"Email\",\n                      name: \"email\",\n                      value: form[step === 1 ? 'from' : 'to'].email,\n                      onChange: event => handleOnChange(event, step === 1 ? 'from' : 'to')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 286,\n                      columnNumber: 37\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 33\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true) : '', step === 3 && load_selected ? /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 4\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 4\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 4\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [\"Load: \", load_selected.loadNumber || '--']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 306,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [\"Broker: \", load_selected.brokerage || '--']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 313,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 318,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [\"Rate: \", load_selected.rate || '--']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 320,\n                    columnNumber: 37\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 322,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    ref: rcfr,\n                    onChange: event => uploadDocument('rateConfirmation', event.target.files),\n                    type: \"file\",\n                    name: \"rateConfirmation\",\n                    multiple: true,\n                    style: {\n                      opacity: 0\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 327,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: 0\n                    },\n                    children: [\"Rate Confirmation:\", Array.isArray(load_selected.rateConfirmation) && load_selected.rateConfirmation.length > 0 && typeof load_selected.rateConfirmation[0] !== 'string' ? /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: () => deleteDocument('rateConfirmation'),\n                      variant: \"contained\",\n                      style: {\n                        backgroundColor: 'red',\n                        color: '#ffffff'\n                      },\n                      children: \"Delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 340,\n                      columnNumber: 45\n                    }, this) : /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: () => rcfr.current.click(),\n                      variant: \"contained\",\n                      color: \"primary\",\n                      children: \"Upload\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 346,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 37\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 326,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 6,\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    ref: pdfr,\n                    onChange: event => uploadDocument('proofDelivery', event.target.files),\n                    type: \"file\",\n                    name: \"proofDelivery\",\n                    multiple: true,\n                    style: {\n                      opacity: 0\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 359,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    style: {\n                      margin: 0\n                    },\n                    children: [\"Proof of Delivery:\", Array.isArray(load_selected.proofDelivery) && load_selected.proofDelivery.length > 0 && typeof load_selected.proofDelivery[0] !== 'string' ? /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: () => deleteDocument('proofDelivery'),\n                      variant: \"contained\",\n                      style: {\n                        backgroundColor: 'red',\n                        color: '#ffffff'\n                      },\n                      children: \"Delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 372,\n                      columnNumber: 45\n                    }, this) : /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: () => pdfr.current.click(),\n                      variant: \"contained\",\n                      color: \"primary\",\n                      children: \"Upload\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 378,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 366,\n                    columnNumber: 37\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 3\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 57\n            }, this) : '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.modalFooter,\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                spacing: 2,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 2,\n                  children: step !== 3 ? /*#__PURE__*/_jsxDEV(IconButton, {\n                    children: step > 1 ? /*#__PURE__*/_jsxDEV(ArrowBackIcon, {\n                      onClick: () => changeStep('back')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 399,\n                      columnNumber: 62\n                    }, this) : ''\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 398,\n                    columnNumber: 45\n                  }, this) : ''\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 2\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 404,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  xs: 8,\n                  className: classes.btn_container,\n                  children: [step !== 3 ? /*#__PURE__*/_jsxDEV(IconButton, {\n                    children: /*#__PURE__*/_jsxDEV(ArrowForwardIcon, {\n                      onClick: () => changeStep('next')\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 411,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 409,\n                    columnNumber: 45\n                  }, this) : '', step === 3 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"contained\",\n                      color: \"primary\",\n                      onClick: () => changeStep('back'),\n                      style: {\n                        marginRight: '5px'\n                      },\n                      children: \"Back\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 416,\n                      columnNumber: 41\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"contained\",\n                      color: \"primary\",\n                      onClick: () => handleSubmit(),\n                      children: \"Create\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 421,\n                      columnNumber: 41\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 415,\n                    columnNumber: 52\n                  }, this) : '']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 405,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 13\n  }, this);\n}\n\n_s(InvoiceWizard, \"glf+HlqfzD+IRuhTaCRi78pKtIA=\", false, function () {\n  return [useStyles, useDispatch];\n});\n\n_c = InvoiceWizard;\n\nvar _c;\n\n$RefreshReg$(_c, \"InvoiceWizard\");","map":{"version":3,"sources":["/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdok/client/src/components/invoices/InvoicesWizard.js"],"names":["React","useState","useRef","useEffect","Modal","Step","makeStyles","Grid","TextField","Button","IconButton","ArrowForwardIcon","ArrowBackIcon","useDispatch","deleteLoadDocument","uploadLoadDocument","generateInvoice","mergeDocuments","resetInvoiceGenerated","Page","Text","View","Document","StyleSheet","PDFDownloadLink","pdf","saveAs","styles","create","page","flexDirection","backgroundColor","section","margin","padding","textAlign","generatePDFDocument","from","to","load_number","broker","rate","Promise","resolve","blob","name","company_name","email","toBlob","useStyles","theme","paper","position","palette","background","border","boxShadow","shadows","spacing","root","flexGrow","formControl","minWidth","resizeDialog","fontSize","modalBody","width","minHeight","modalFooter","btn_container","getModalStyle","top","left","transform","overflowY","height","formInitialState","InvoiceWizard","load_selected","handleOnClose","deleteDoc","updateDoc","invoiceGenerated","classes","dispatch","modalStyle","form","setForm","step","setStep","rcfr","pdfr","handleSubmit","event","preventDefault","_id","loadNumber","brokerage","reader","FileReader","readAsDataURL","onloadend","base64data","result","headers","responseType","Accept","dataToSend","invoice","docs","rateConfirmation","length","console","log","push","proofDelivery","file","Blob","type","handleOnChange","key","value","target","changeStep","move","new_step","error","errorMsg","validateEmail","alert","re","test","String","toLowerCase","deleteDocument","doc_type","setTimeout","uploadDocument","documents","file_data","filename","date","Date","now","files","opacity","Array","isArray","color","current","click","marginRight"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,SAASC,KAAT,EAAgBC,IAAhB,QAA4B,mBAA5B;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,SAASC,MAAT,QAAuB,mBAAvB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,gBAAP,MAA6B,iCAA7B;AACA,OAAOC,aAAP,MAA0B,8BAA1B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,kBAAT,EAA6BC,kBAA7B,EAAiDC,eAAjD,EAAkEC,cAAlE,EAAkFC,qBAAlF,QAA+G,oBAA/G;AACA,SAASC,IAAT,EAAeC,IAAf,EAAqBC,IAArB,EAA2BC,QAA3B,EAAqCC,UAArC,EAAiDC,eAAjD,EAAkEC,GAAlE,QAA6E,qBAA7E;AACA,SAASC,MAAT,QAAuB,YAAvB;;;AAEA,MAAMC,MAAM,GAAGJ,UAAU,CAACK,MAAX,CAAkB;AAC7BC,EAAAA,IAAI,EAAE;AACJC,IAAAA,aAAa,EAAE,QADX;AAEJC,IAAAA,eAAe,EAAE;AAFb,GADuB;AAK7BC,EAAAA,OAAO,EAAE;AACPC,IAAAA,MAAM,EAAE,CADD;AAEPC,IAAAA,OAAO,EAAE,CAFF;AAGPC,IAAAA,SAAS,EAAE;AAHJ;AALoB,CAAlB,CAAf;;AAYA,MAAMC,mBAAmB,GAAG,OAAO;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,EAAR;AAAYC,EAAAA,WAAZ;AAAyBC,EAAAA,MAAzB;AAAiCC,EAAAA;AAAjC,CAAP,KAAmD;AAC3E,SAAO,IAAIC,OAAJ,CAAY,MAAOC,OAAP,IAAmB;AAClC,UAAMC,IAAI,GAAG,MAAMnB,GAAG,eAClB,QAAC,QAAD;AAAA,6BACI,QAAC,IAAD;AAAM,QAAA,IAAI,EAAC,IAAX;AAAgB,QAAA,KAAK,EAAEE,MAAM,CAACE,IAA9B;AAAA,gCACI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAEF,MAAM,CAACK,OAApB;AAAA,kCACI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAA,iCAAaK,IAAI,CAACQ,IAAlB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI,QAAC,IAAD;AAAA,yCAAqBR,IAAI,CAACS,YAA1B;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ,eAII,QAAC,IAAD;AAAA,kCAAcT,IAAI,CAACU,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAOI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAEpB,MAAM,CAACK,OAApB;AAAA,kCACI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAA,yCAAqBM,EAAE,CAACQ,YAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI,QAAC,IAAD;AAAA,kCAAcR,EAAE,CAACS,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPJ,eAYI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAEpB,MAAM,CAACK,OAApB;AAAA,kCACI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAA,sBAAOO;AAAP;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAZJ,eAgBI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA,gBAhBJ,eAiBI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAEZ,MAAM,CAACK,OAApB;AAAA,kCACI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAA,sBAAOQ,MAAM,GAAGA,MAAH,GAAY;AAAzB;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBJ,eAqBI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAEb,MAAM,CAACK,OAApB;AAAA,kCACI,QAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,IAAD;AAAA,sBAAOS,IAAI,GAAGA,IAAH,GAAS;AAApB;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBArBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADkB,CAAH,CA6BjBO,MA7BiB,EAAnB;AA+BAL,IAAAA,OAAO,CAACC,IAAD,CAAP;AACH,GAjCM,CAAP;AAkCH,CAnCD;;AAsCA,MAAMK,SAAS,GAAG3C,UAAU,CAAE4C,KAAD,KAAY;AACrCC,EAAAA,KAAK,EAAE;AACHC,IAAAA,QAAQ,EAAE,UADP;AAEHrB,IAAAA,eAAe,EAAEmB,KAAK,CAACG,OAAN,CAAcC,UAAd,CAAyBH,KAFvC;AAGHI,IAAAA,MAAM,EAAE,gBAHL;AAIHC,IAAAA,SAAS,EAAEN,KAAK,CAACO,OAAN,CAAc,CAAd,CAJR;AAKHvB,IAAAA,OAAO,EAAEgB,KAAK,CAACQ,OAAN,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB;AALN,GAD8B;AAQrCC,EAAAA,IAAI,EAAE;AACFC,IAAAA,QAAQ,EAAE,CADR;AAEF9B,IAAAA,aAAa,EAAE,KAFb;AAGFK,IAAAA,SAAS,EAAE;AAHT,GAR+B;AAarC0B,EAAAA,WAAW,EAAE;AACT5B,IAAAA,MAAM,EAAEiB,KAAK,CAACQ,OAAN,CAAc,CAAd,CADC;AAETI,IAAAA,QAAQ,EAAE;AAFD,GAbwB;AAiBrCC,EAAAA,YAAY,EAAE;AACVC,IAAAA,QAAQ,EAAE;AADA,GAjBuB;AAoBrCC,EAAAA,SAAS,EAAE;AACPC,IAAAA,KAAK,EAAE,MADA;AAEPC,IAAAA,SAAS,EAAE;AAFJ,GApB0B;AAwBrCC,EAAAA,WAAW,EAAE;AACTF,IAAAA,KAAK,EAAE;AADE,GAxBwB;AA2BrCG,EAAAA,aAAa,EAAE;AACXlC,IAAAA,SAAS,EAAE;AADA;AA3BsB,CAAZ,CAAD,CAA5B;;AA+BA,MAAMmC,aAAa,GAAG,MAAM;AACxB,SAAO;AACHC,IAAAA,GAAG,EAAE,KADF;AAEHC,IAAAA,IAAI,EAAE,KAFH;AAGHN,IAAAA,KAAK,EAAE,OAHJ;AAIHO,IAAAA,SAAS,EAAE,uBAJR;AAKHC,IAAAA,SAAS,EAAE,MALR;AAMHC,IAAAA,MAAM,EAAE;AANL,GAAP;AAQH,CATD;;AAUA,MAAMC,gBAAgB,GAAG;AACrBvC,EAAAA,IAAI,EAAE;AACFQ,IAAAA,IAAI,EAAE,EADJ;AAEFC,IAAAA,YAAY,EAAE,EAFZ;AAGFC,IAAAA,KAAK,EAAE;AAHL,GADe;AAMrBT,EAAAA,EAAE,EAAE;AACAQ,IAAAA,YAAY,EAAE,EADd;AAEAC,IAAAA,KAAK,EAAE;AAFP;AANiB,CAAzB;AAYA,eAAe,SAAS8B,aAAT,CAAuB;AAAEC,EAAAA,aAAF;AAAiBC,EAAAA,aAAjB;AAAgCC,EAAAA,SAAhC;AAA2CC,EAAAA,SAA3C;AAAsDC,EAAAA;AAAtD,CAAvB,EAAiG;AAAA;;AAE5G,QAAMC,OAAO,GAAGlC,SAAS,EAAzB;AACA,QAAMmC,QAAQ,GAAGvE,WAAW,EAA5B;AAEA,QAAM,CAACwE,UAAD,IAAepF,QAAQ,CAACqE,aAAD,CAA7B;AACA,QAAM,CAACgB,IAAD,EAAOC,OAAP,IAAkBtF,QAAQ,CAAC2E,gBAAD,CAAhC;AACA,QAAM,CAACY,IAAD,EAAOC,OAAP,IAAkBxF,QAAQ,CAAC,CAAD,CAAhC;AAEA,QAAMyF,IAAI,GAAGxF,MAAM,EAAnB;AACA,QAAMyF,IAAI,GAAGzF,MAAM,EAAnB;;AAEA,QAAM0F,YAAY,GAAG,OAAOC,KAAK,GAAG,IAAf,KAAwB;AACzC,QAAIA,KAAJ,EACIA,KAAK,CAACC,cAAN;AAEJV,IAAAA,QAAQ,CAACpE,eAAe,CAAC8D,aAAa,CAACiB,GAAf,EAAoBT,IAApB,CAAhB,CAAR;AAEA,UAAM1C,IAAI,GAAG,MAAMR,mBAAmB,CAAC;AACnCC,MAAAA,IAAI,EAAEiD,IAAI,CAACjD,IADwB;AAEnCC,MAAAA,EAAE,EAAEgD,IAAI,CAAChD,EAF0B;AAGnCC,MAAAA,WAAW,EAAEuC,aAAa,CAACkB,UAHQ;AAInCxD,MAAAA,MAAM,EAAEsC,aAAa,CAACmB,SAJa;AAKnCxD,MAAAA,IAAI,EAAEqC,aAAa,CAACrC;AALe,KAAD,CAAtC;AAQA,QAAIyD,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACAD,IAAAA,MAAM,CAACE,aAAP,CAAqBxD,IAArB;;AACAsD,IAAAA,MAAM,CAACG,SAAP,GAAmB,YAAY;AAC3B,UAAIC,UAAU,GAAGJ,MAAM,CAACK,MAAxB;AAEA,YAAMC,OAAO,GAAG;AACZC,QAAAA,YAAY,EAAE,aADF;AAEZD,QAAAA,OAAO,EAAE;AACLE,UAAAA,MAAM,EAAE;AADH;AAFG,OAAhB;AAOA,YAAMC,UAAU,GAAG;AACfC,QAAAA,OAAO,EAAEN,UADM;AAEfO,QAAAA,IAAI,EAAE;AAFS,OAAnB;;AAKA,UAAI/B,aAAa,CAACgC,gBAAd,IAAkChC,aAAa,CAACgC,gBAAd,CAA+BC,MAA/B,GAAwC,CAA9E,EAAiF;AAAEC,QAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCnC,aAAa,CAACgC,gBAAd,CAA+B,CAA/B,CAAnC;AAC/EH,QAAAA,UAAU,CAACE,IAAX,CAAgBK,IAAhB,CAAqBpC,aAAa,CAACgC,gBAAd,CAA+B,CAA/B,EAAkCjE,IAAvD;AACH;;AAED,UAAIiC,aAAa,CAACqC,aAAd,IAA+BrC,aAAa,CAACqC,aAAd,CAA4BJ,MAA5B,GAAqC,CAAxE,EAA2E;AAAEC,QAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCnC,aAAa,CAACqC,aAAd,CAA4B,CAA5B,CAAhC;AACzER,QAAAA,UAAU,CAACE,IAAX,CAAgBK,IAAhB,CAAqBpC,aAAa,CAACqC,aAAd,CAA4B,CAA5B,EAA+BtE,IAApD;AACH;;AAEDuC,MAAAA,QAAQ,CAACnE,cAAc,CAAC0F,UAAD,EAAaH,OAAb,CAAf,CAAR;AACH,KAxBD;AAyBH,GAzCD;;AA2CArG,EAAAA,SAAS,CAAC,MAAM;AACZiF,IAAAA,QAAQ,CAAClE,qBAAqB,EAAtB,CAAR;AACH,GAFQ,EAEN,EAFM,CAAT;AAIAf,EAAAA,SAAS,CAAC,MAAM;AACZ6G,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBnC,aAAzB;;AACA,QAAII,gBAAJ,EAAsB;AAClB,YAAMkC,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACnC,gBAAD,CAAT,EAA6B;AACtCoC,QAAAA,IAAI,EAAE;AADgC,OAA7B,CAAb;AAIA5F,MAAAA,MAAM,CAAC0F,IAAD,EAAO,SAAP,CAAN;AACAhC,MAAAA,QAAQ,CAAClE,qBAAqB,EAAtB,CAAR;AACA6D,MAAAA,aAAa;AAChB;AACJ,GAXQ,EAWN,CAACG,gBAAD,EAAmBJ,aAAnB,CAXM,CAAT;;AAaA,QAAMyC,cAAc,GAAG,CAAC1B,KAAD,EAAQ2B,GAAR,KAAgB;AACnC,UAAM;AAAE3E,MAAAA,IAAF;AAAQ4E,MAAAA;AAAR,QAAkB5B,KAAK,CAAC6B,MAA9B;AACAnC,IAAAA,OAAO,CAACD,IAAI,KAAK,EAAE,GAAGA,IAAL;AAAW,OAACkC,GAAD,GAAO,EAAE,GAAGlC,IAAI,CAACkC,GAAD,CAAT;AAAgB,SAAC3E,IAAD,GAAQ4E;AAAxB;AAAlB,KAAL,CAAL,CAAP;AACH,GAHD;;AAKA,QAAME,UAAU,GAAIC,IAAD,IAAU;AACzB,UAAMC,QAAQ,GAAGD,IAAI,KAAK,MAAT,GAAkBpC,IAAI,GAAC,CAAvB,GAA2BA,IAAI,GAAC,CAAjD;AACA,QAAIsC,KAAK,GAAG,KAAZ;AACA,QAAIC,QAAQ,GAAG,EAAf;;AACA,QAAI,CAACvC,IAAI,KAAK,CAAT,IAAcA,IAAI,KAAK,CAAxB,MACFF,IAAI,CAACjD,IAAL,CAAUU,KAAV,IAAmB,CAACiF,aAAa,CAAC1C,IAAI,CAACjD,IAAL,CAAUU,KAAX,CAAlC,IAAyDuC,IAAI,CAAChD,EAAL,CAAQS,KAAR,IAAiB,CAACiF,aAAa,CAAC1C,IAAI,CAAChD,EAAL,CAAQS,KAAT,CADrF,CAAJ,EAC4G;AACxG+E,MAAAA,KAAK,GAAG,IAAR;AACAC,MAAAA,QAAQ,GAAG,eAAX;AACH;;AACD,QAAIvC,IAAI,KAAK,CAAT,KAAe,CAACF,IAAI,CAACjD,IAAL,CAAUQ,IAAX,IAAmB,CAACyC,IAAI,CAACjD,IAAL,CAAUS,YAA9B,IAA8C,CAACwC,IAAI,CAACjD,IAAL,CAAUU,KAAxE,CAAJ,EAAoF;AAChF+E,MAAAA,KAAK,GAAG,IAAR;AACAC,MAAAA,QAAQ,GAAG,mCAAX;AACH;;AACD,QAAIvC,IAAI,KAAK,CAAT,KAAe,CAACF,IAAI,CAAChD,EAAL,CAAQQ,YAAT,IAAyB,CAACwC,IAAI,CAAChD,EAAL,CAAQS,KAAjD,CAAJ,EAA6D;AACzD+E,MAAAA,KAAK,GAAG,IAAR;AACAC,MAAAA,QAAQ,GAAG,mCAAX;AACH;;AACD,QAAIH,IAAI,KAAK,MAAT,IAAmBE,KAAvB,EACIG,KAAK,CAACF,QAAD,CAAL,CADJ,KAGItC,OAAO,CAACoC,QAAD,CAAP;AACP,GArBD;;AAsBA,QAAMG,aAAa,GAAGjF,KAAK,IAAI;AAC3B,UAAMmF,EAAE,GAAG,uJAAX;AACA,WAAOA,EAAE,CAACC,IAAH,CAAQC,MAAM,CAACrF,KAAD,CAAN,CAAcsF,WAAd,EAAR,CAAP;AACH,GAHD;;AAIA,QAAMC,cAAc,GAAGC,QAAQ,IAAI;AAC/BnD,IAAAA,QAAQ,CAACtE,kBAAkB,CAACgE,aAAa,CAACiB,GAAf,EAAoBwC,QAApB,EAA8B,EAA9B,CAAnB,CAAR,CAD+B,CAE/B;;AACAC,IAAAA,UAAU,CAAC,MAAM;AAACxD,MAAAA,SAAS,CAACuD,QAAD,CAAT;AAAoB,KAA5B,EAA8B,IAA9B,CAAV;AACH,GAJD;;AAKA,QAAME,cAAc,GAAG,CAACF,QAAD,EAAWG,SAAX,KAAyB;AAC5C,UAAMC,SAAS,GAAG,EAAlB;;AACA,SAAK,IAAIvB,IAAT,IAAiBsB,SAAjB,EAA4B;AACxB,YAAM;AAAEE,QAAAA;AAAF,UAAexB,IAArB;AACAuB,MAAAA,SAAS,CAACzB,IAAV,CAAe;AACXrE,QAAAA,IAAI,EAAE+F,QADK;AAEXC,QAAAA,IAAI,EAAEC,IAAI,CAACC,GAAL;AAFK,OAAf;AAIH;;AACD3D,IAAAA,QAAQ,CAACrE,kBAAkB,CAAC+D,aAAa,CAACiB,GAAf,EAAoBwC,QAApB,EAA8BG,SAA9B,CAAnB,CAAR;AACAF,IAAAA,UAAU,CAAC,MAAM;AAACvD,MAAAA,SAAS,CAACsD,QAAD,EAAWI,SAAX,CAAT;AAA+B,KAAvC,EAAyC,IAAzC,CAAV;AACH,GAXD;;AAYA,sBAAQ,QAAC,KAAD;AACR,IAAA,IAAI,EAAE7D,aAAa,GAAG,IAAH,GAAU,KADrB;AAER,IAAA,OAAO,EAAE,MAAI;AACTC,MAAAA,aAAa;AACbQ,MAAAA,OAAO,CAACX,gBAAD,CAAP;AACAa,MAAAA,OAAO,CAAC,CAAD,CAAP;AACH,KANO;AAAA,2BAOJ;AAAK,MAAA,KAAK,EAAEJ,UAAZ;AAAwB,MAAA,SAAS,EAAEF,OAAO,CAAChC,KAA3C;AAAA,6BACI;AAAM,QAAA,QAAQ,EAAEyC,YAAhB;AAAA,+BACI,QAAC,IAAD;AAAM,UAAA,SAAS,MAAf;AAAgB,UAAA,OAAO,EAAE,CAAzB;AAA4B,UAAA,SAAS,EAAET,OAAO,CAACxB,IAA/C;AAAA,kCACI;AAAK,YAAA,SAAS,EAAEwB,OAAO,CAAClB,SAAxB;AAAA,uBACMuB,IAAI,KAAK,CAAT,gBAAa,QAAC,IAAD;AAAM,cAAA,IAAI,MAAV;AAAW,cAAA,EAAE,EAAE,EAAf;AAAA,qCACX;AAAA,0BAAMA,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB;AAA5B;AAAA;AAAA;AAAA;AAAA;AADW;AAAA;AAAA;AAAA;AAAA,oBAAb,GAEQ,EAHd,EAIMA,IAAI,KAAK,CAAT,gBAAa,QAAC,IAAD;AAAM,cAAA,IAAI,MAAV;AAAW,cAAA,EAAE,EAAE,EAAf;AAAA,qCACX,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,yCACI,QAAC,SAAD;AACA,oBAAA,EAAE,EAAC,gBADH;AAEA,oBAAA,OAAO,EAAC,UAFR;AAGA,oBAAA,KAAK,EAAC,MAHN;AAIA,oBAAA,IAAI,EAAC,MAJL;AAKA,oBAAA,KAAK,EAAEF,IAAI,CAACE,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAAvB,CAAJ,CAAiC3C,IALxC;AAMA,oBAAA,QAAQ,EAAGgD,KAAD,IAAW0B,cAAc,CAAC1B,KAAD,EAAQL,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAA9B;AANnC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAWI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBAXJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADW;AAAA;AAAA;AAAA;AAAA,oBAAb,GAcQ,EAlBd,EAmBMA,IAAI,GAAG,CAAP,gBAAW;AAAA,sCAAE,QAAC,IAAD;AAAM,gBAAA,IAAI,MAAV;AAAW,gBAAA,EAAE,EAAE,EAAf;AAAA,uCACX,QAAC,IAAD;AAAM,kBAAA,SAAS,MAAf;AAAgB,kBAAA,OAAO,EAAE,CAAzB;AAAA,0CACI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE,CAAf;AAAA,2CACI,QAAC,SAAD;AACA,sBAAA,EAAE,EAAC,gBADH;AAEA,sBAAA,OAAO,EAAC,UAFR;AAGA,sBAAA,KAAK,EAAC,cAHN;AAIA,sBAAA,IAAI,EAAC,cAJL;AAKA,sBAAA,KAAK,EAAEF,IAAI,CAACE,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAAvB,CAAJ,CAAiC1C,YALxC;AAMA,sBAAA,QAAQ,EAAG+C,KAAD,IAAW0B,cAAc,CAAC1B,KAAD,EAAQL,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAA9B;AANnC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,0BAFJ,eAWI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,0BAXJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADW;AAAA;AAAA;AAAA;AAAA,sBAAF,eAeb,QAAC,IAAD;AAAM,gBAAA,IAAI,MAAV;AAAW,gBAAA,EAAE,EAAE,EAAf;AAAA,uCACI,QAAC,IAAD;AAAM,kBAAA,SAAS,MAAf;AAAgB,kBAAA,OAAO,EAAE,CAAzB;AAAA,0CACI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE,CAAf;AAAA,2CACI,QAAC,SAAD;AACA,sBAAA,EAAE,EAAC,gBADH;AAEA,sBAAA,OAAO,EAAC,UAFR;AAGA,sBAAA,KAAK,EAAC,OAHN;AAIA,sBAAA,IAAI,EAAC,OAJL;AAKA,sBAAA,KAAK,EAAEF,IAAI,CAACE,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAAvB,CAAJ,CAAiCzC,KALxC;AAMA,sBAAA,QAAQ,EAAG8C,KAAD,IAAW0B,cAAc,CAAC1B,KAAD,EAAQL,IAAI,KAAK,CAAT,GAAa,MAAb,GAAsB,IAA9B;AANnC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,0BAFJ,eAWI,QAAC,IAAD;AAAM,oBAAA,IAAI,MAAV;AAAW,oBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,0BAXJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBAfa;AAAA,4BAAX,GA6BW,EAhDjB,EAiDMA,IAAI,KAAK,CAAT,IAAcV,aAAd,gBAA8B,QAAC,IAAD;AAAM,cAAA,IAAI,MAAV;AAAW,cAAA,EAAE,EAAE,EAAf;AAAA,sCAC5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAD4B,eAM5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,yCACI;AAAA,yCAAWA,aAAa,CAACkB,UAAd,IAA4B,IAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAKI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAN4B,eAa5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,yCACI;AAAA,2CAAalB,aAAa,CAACmB,SAAd,IAA2B,IAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAKI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAb4B,eAoB5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,yCACI;AAAA,yCAAWnB,aAAa,CAACrC,IAAd,IAAsB,IAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAKI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBApB4B,eA2B5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,0CACI;AACA,oBAAA,GAAG,EAAEiD,IADL;AAEA,oBAAA,QAAQ,EAAEG,KAAK,IAAG4C,cAAc,CAAC,kBAAD,EAAqB5C,KAAK,CAAC6B,MAAN,CAAasB,KAAlC,CAFhC;AAGA,oBAAA,IAAI,EAAC,MAHL;AAIA,oBAAA,IAAI,EAAC,kBAJL;AAKA,oBAAA,QAAQ,MALR;AAMA,oBAAA,KAAK,EAAE;AAACC,sBAAAA,OAAO,EAAE;AAAV;AANP;AAAA;AAAA;AAAA;AAAA,0BADJ,eAQI;AAAG,oBAAA,KAAK,EAAE;AAAChH,sBAAAA,MAAM,EAAC;AAAR,qBAAV;AAAA,qDAGQiH,KAAK,CAACC,OAAN,CAAcrE,aAAa,CAACgC,gBAA5B,KACAhC,aAAa,CAACgC,gBAAd,CAA+BC,MAA/B,GAAwC,CADxC,IAEA,OAAOjC,aAAa,CAACgC,gBAAd,CAA+B,CAA/B,CAAP,KAA6C,QAF7C,gBAGA,QAAC,MAAD;AACA,sBAAA,OAAO,EAAE,MAAIwB,cAAc,CAAC,kBAAD,CAD3B;AAEA,sBAAA,OAAO,EAAC,WAFR;AAGA,sBAAA,KAAK,EAAE;AAACvG,wBAAAA,eAAe,EAAC,KAAjB;AAAuBqH,wBAAAA,KAAK,EAAC;AAA7B,uBAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAHA,gBASA,QAAC,MAAD;AACA,sBAAA,OAAO,EAAE,MAAI1D,IAAI,CAAC2D,OAAL,CAAaC,KAAb,EADb;AAEA,sBAAA,OAAO,EAAC,WAFR;AAEoB,sBAAA,KAAK,EAAC,SAF1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAZR;AAAA;AAAA;AAAA;AAAA;AAAA,0BARJ;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,eA8BI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBA9BJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBA3B4B,eA2D5B,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,0CACI;AACA,oBAAA,GAAG,EAAE3D,IADL;AAEA,oBAAA,QAAQ,EAAEE,KAAK,IAAG4C,cAAc,CAAC,eAAD,EAAkB5C,KAAK,CAAC6B,MAAN,CAAasB,KAA/B,CAFhC;AAGA,oBAAA,IAAI,EAAC,MAHL;AAIA,oBAAA,IAAI,EAAC,eAJL;AAKA,oBAAA,QAAQ,MALR;AAMA,oBAAA,KAAK,EAAE;AAACC,sBAAAA,OAAO,EAAE;AAAV;AANP;AAAA;AAAA;AAAA;AAAA,0BADJ,eAQI;AAAG,oBAAA,KAAK,EAAE;AAAChH,sBAAAA,MAAM,EAAC;AAAR,qBAAV;AAAA,qDAGQiH,KAAK,CAACC,OAAN,CAAcrE,aAAa,CAACqC,aAA5B,KACArC,aAAa,CAACqC,aAAd,CAA4BJ,MAA5B,GAAqC,CADrC,IAEA,OAAOjC,aAAa,CAACqC,aAAd,CAA4B,CAA5B,CAAP,KAA0C,QAF1C,gBAGA,QAAC,MAAD;AACA,sBAAA,OAAO,EAAE,MAAImB,cAAc,CAAC,eAAD,CAD3B;AAEA,sBAAA,OAAO,EAAC,WAFR;AAGA,sBAAA,KAAK,EAAE;AAACvG,wBAAAA,eAAe,EAAC,KAAjB;AAAuBqH,wBAAAA,KAAK,EAAC;AAA7B,uBAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAHA,gBASA,QAAC,MAAD;AACA,sBAAA,OAAO,EAAE,MAAIzD,IAAI,CAAC0D,OAAL,CAAaC,KAAb,EADb;AAEA,sBAAA,OAAO,EAAC,WAFR;AAGA,sBAAA,KAAK,EAAC,SAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAZR;AAAA;AAAA;AAAA;AAAA;AAAA,0BARJ;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,eA+BI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBA/BJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBA3D4B;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA9B,GA4FQ,EA7Id;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAgJI;AAAK,YAAA,SAAS,EAAEnE,OAAO,CAACf,WAAxB;AAAA,mCACI,QAAC,IAAD;AAAM,cAAA,IAAI,MAAV;AAAW,cAAA,EAAE,EAAE,EAAf;AAAA,qCACI,QAAC,IAAD;AAAM,gBAAA,SAAS,MAAf;AAAgB,gBAAA,OAAO,EAAE,CAAzB;AAAA,wCACI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAA,4BAEQoB,IAAI,KAAK,CAAT,gBAEI,QAAC,UAAD;AAAA,8BACMA,IAAI,GAAG,CAAP,gBAAW,QAAC,aAAD;AAAe,sBAAA,OAAO,EAAE,MAAImC,UAAU,CAAC,MAAD;AAAtC;AAAA;AAAA;AAAA;AAAA,4BAAX,GAA+D;AADrE;AAAA;AAAA;AAAA;AAAA,0BAFJ,GAKI;AAPZ;AAAA;AAAA;AAAA;AAAA,wBADJ,eAWI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE;AAAf;AAAA;AAAA;AAAA;AAAA,wBAXJ,eAYI,QAAC,IAAD;AAAM,kBAAA,IAAI,MAAV;AAAW,kBAAA,EAAE,EAAE,CAAf;AAAkB,kBAAA,SAAS,EAAExC,OAAO,CAACd,aAArC;AAAA,6BAEQmB,IAAI,KAAK,CAAT,gBAEI,QAAC,UAAD;AAAA,2CAEI,QAAC,gBAAD;AAAkB,sBAAA,OAAO,EAAE,MAAImC,UAAU,CAAC,MAAD;AAAzC;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,0BAFJ,GAMI,EARZ,EAUMnC,IAAI,KAAK,CAAT,gBAAa;AAAA,4CACX,QAAC,MAAD;AACA,sBAAA,OAAO,EAAC,WADR;AAEA,sBAAA,KAAK,EAAC,SAFN;AAGA,sBAAA,OAAO,EAAE,MAAImC,UAAU,CAAC,MAAD,CAHvB;AAIA,sBAAA,KAAK,EAAE;AAAC4B,wBAAAA,WAAW,EAAC;AAAb,uBAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADW,eAMX,QAAC,MAAD;AAAQ,sBAAA,OAAO,EAAC,WAAhB;AAA4B,sBAAA,KAAK,EAAC,SAAlC;AAA4C,sBAAA,OAAO,EAAE,MAAI3D,YAAY,EAArE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BANW;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAb,GAOO,EAjBb;AAAA;AAAA;AAAA;AAAA;AAAA,wBAZJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,kBAhJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AAPI;AAAA;AAAA;AAAA;AAAA,UAAR;AAiMH;;GAzTuBf,a;UAEJ5B,S,EACCpC,W;;;KAHGgE,a","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Modal, Step } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport { Button } from '@material-ui/core';\nimport IconButton from '@material-ui/core/IconButton';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport { useDispatch } from 'react-redux';\nimport { deleteLoadDocument, uploadLoadDocument, generateInvoice, mergeDocuments, resetInvoiceGenerated } from '../../actions/load';\nimport { Page, Text, View, Document, StyleSheet, PDFDownloadLink, pdf } from '@react-pdf/renderer';\nimport { saveAs } from \"file-saver\";\n\nconst styles = StyleSheet.create({\n    page: {\n      flexDirection: 'column',\n      backgroundColor: '#E4E4E4'\n    },\n    section: {\n      margin: 5,\n      padding: 5,\n      textAlign: 'center'\n    }\n});\n\nconst generatePDFDocument = async ({ from, to, load_number, broker, rate }) => {\n    return new Promise(async (resolve) => {\n        const blob = await pdf(\n            <Document>\n                <Page size=\"A4\" style={styles.page}>\n                    <View style={styles.section}>\n                        <Text>From</Text>\n                        <Text>Name: {from.name}</Text>\n                        <Text>Company Name: {from.company_name}</Text>\n                        <Text>Email: {from.email}</Text>\n                    </View>\n                    <View style={styles.section}>\n                        <Text>To</Text>\n                        <Text>Company Name: {to.company_name}</Text>\n                        <Text>Email: {to.email}</Text>\n                    </View>\n                    <View style={styles.section}>\n                        <Text>Load</Text>\n                        <Text>{load_number}</Text>\n                    </View>\n                    <View></View>\n                    <View style={styles.section}>\n                        <Text>Broker</Text>\n                        <Text>{broker ? broker : '--'}</Text>\n                    </View>\n                    <View style={styles.section}>\n                        <Text>Rate</Text>\n                        <Text>{rate ? rate: '--'}</Text>\n                    </View>\n                </Page>\n            </Document>\n        ).toBlob();\n    \n        resolve(blob)\n    })\n};\n  \n\nconst useStyles = makeStyles((theme) => ({\n    paper: {\n        position: 'absolute',\n        backgroundColor: theme.palette.background.paper,\n        border: '2px solid #000',\n        boxShadow: theme.shadows[5],\n        padding: theme.spacing(2, 4, 3),\n    },\n    root: {\n        flexGrow: 1,\n        flexDirection: \"row\",\n        textAlign: \"center\"\n    },\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: 120,\n    },\n    resizeDialog: {\n        fontSize: 14,\n    },\n    modalBody: {\n        width: '100%',\n        minHeight: '324px'\n    },\n    modalFooter: {\n        width: '100%',\n    },\n    btn_container: {\n        textAlign: 'end'\n    }\n}));\nconst getModalStyle = () => {\n    return {\n        top: '50%',\n        left: '50%',\n        width: '400px',\n        transform: 'translate(-50%, -50%)',\n        overflowY: 'auto',\n        height: '400px',\n    };\n};\nconst formInitialState = {\n    from: {\n        name: '',\n        company_name: '',\n        email: ''\n    },\n    to: {\n        company_name: '',\n        email: ''\n    }\n};\n\nexport default function InvoiceWizard({ load_selected, handleOnClose, deleteDoc, updateDoc, invoiceGenerated }) {\n    \n    const classes = useStyles();\n    const dispatch = useDispatch();\n    \n    const [modalStyle] = useState(getModalStyle);\n    const [form, setForm] = useState(formInitialState);\n    const [step, setStep] = useState(1);\n    \n    const rcfr = useRef();\n    const pdfr = useRef();\n\n    const handleSubmit = async (event = null) => {\n        if (event)\n            event.preventDefault();\n\n        dispatch(generateInvoice(load_selected._id, form));\n\n        const blob = await generatePDFDocument({\n            from: form.from, \n            to: form.to, \n            load_number: load_selected.loadNumber,\n            broker: load_selected.brokerage,\n            rate: load_selected.rate \n        });\n\n        var reader = new FileReader();\n        reader.readAsDataURL(blob); \n        reader.onloadend = async () => {\n            var base64data = reader.result;                \n            \n            const headers = {\n                responseType: 'arraybuffer',\n                headers: {\n                    Accept: 'application/pdf',\n                }\n            }\n\n            const dataToSend = {\n                invoice: base64data,\n                docs: []\n            }\n\n            if (load_selected.rateConfirmation && load_selected.rateConfirmation.length > 0) { console.log('Rate Confirmation :', load_selected.rateConfirmation[0])\n                dataToSend.docs.push(load_selected.rateConfirmation[0].name)\n            }\n\n            if (load_selected.proofDelivery && load_selected.proofDelivery.length > 0) { console.log('Proof Delivery :', load_selected.proofDelivery[0])\n                dataToSend.docs.push(load_selected.proofDelivery[0].name)\n            }\n\n            dispatch(mergeDocuments(dataToSend, headers));\n        }\n    };\n\n    useEffect(() => {\n        dispatch(resetInvoiceGenerated())\n    }, [])\n\n    useEffect(() => {\n        console.log('Updated :', load_selected)\n        if (invoiceGenerated) {\n            const file = new Blob([invoiceGenerated], {\n                type: \"application/pdf\"\n            });\n    \n            saveAs(file, 'Invoice');\n            dispatch(resetInvoiceGenerated())\n            handleOnClose();\n        }\n    }, [invoiceGenerated, load_selected])\n\n    const handleOnChange = (event, key) => {\n        const { name, value } = event.target;\n        setForm(form => ({ ...form, [key]: { ...form[key], [name]: value } }));\n    };\n\n    const changeStep = (move) => {\n        const new_step = move === 'next' ? step+1 : step-1;\n        let error = false;\n        let errorMsg = '';\n        if ((step === 1 || step === 2) && \n        ((form.from.email && !validateEmail(form.from.email)) || (form.to.email && !validateEmail(form.to.email)))) {\n            error = true;\n            errorMsg = 'Invalid Email';\n        }\n        if (step === 1 && (!form.from.name || !form.from.company_name || !form.from.email)) {\n            error = true;\n            errorMsg = 'Please fill the form to continue.';\n        }\n        if (step === 2 && (!form.to.company_name || !form.to.email)) {\n            error = true;\n            errorMsg = 'Please fill the form to continue.';\n        }\n        if (move === 'next' && error)\n            alert(errorMsg);\n        else\n            setStep(new_step);\n    };\n    const validateEmail = email => {\n        const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.test(String(email).toLowerCase());\n    }\n    const deleteDocument = doc_type => {\n        dispatch(deleteLoadDocument(load_selected._id, doc_type, ''));\n        // remove timer and get actual state of invoice to show the upload button instead of delete button on delete success\n        setTimeout(() => {deleteDoc(doc_type)}, 2000);\n    };\n    const uploadDocument = (doc_type, documents) => {\n        const file_data = [];\n        for (let file of documents) {\n            const { filename } = file;\n            file_data.push({\n                name: filename,\n                date: Date.now()\n            });\n        }\n        dispatch(uploadLoadDocument(load_selected._id, doc_type, documents));\n        setTimeout(() => {updateDoc(doc_type, file_data)}, 2000);\n    }\n    return (<Modal\n    open={load_selected ? true : false}\n    onClose={()=>{\n        handleOnClose();\n        setForm(formInitialState);\n        setStep(1);\n    }}>\n        <div style={modalStyle} className={classes.paper}>\n            <form onSubmit={handleSubmit}>\n                <Grid container spacing={2} className={classes.root}>\n                    <div className={classes.modalBody}>\n                        { step !== 3 ? <Grid item xs={12}>\n                            <h3>{ step === 1 ? 'From' : 'To' }</h3>\n                        </Grid> : '' }\n                        { step === 1 ? <Grid item xs={12}>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <TextField \n                                    id=\"outlined-basic\" \n                                    variant=\"outlined\" \n                                    label=\"Name\"\n                                    name=\"name\"\n                                    value={form[step === 1 ? 'from' : 'to'].name}\n                                    onChange={(event) => handleOnChange(event, step === 1 ? 'from' : 'to')} />\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                        </Grid> : '' }\n                        { step < 3 ? <><Grid item xs={12}>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <TextField \n                                    id=\"outlined-basic\" \n                                    variant=\"outlined\" \n                                    label=\"Company Name\"\n                                    name=\"company_name\"\n                                    value={form[step === 1 ? 'from' : 'to'].company_name}\n                                    onChange={(event) => handleOnChange(event, step === 1 ? 'from' : 'to')} />\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                        </Grid>\n                        <Grid item xs={12}>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <TextField \n                                    id=\"outlined-basic\" \n                                    variant=\"outlined\" \n                                    label=\"Email\"\n                                    name=\"email\"\n                                    value={form[step === 1 ? 'from' : 'to'].email}\n                                    onChange={(event) => handleOnChange(event, step === 1 ? 'from' : 'to')} />\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                        </Grid></> : '' }\n                        { step === 3 && load_selected ? <Grid item xs={12}>\n                            <Grid container spacing={2}>\n                                <Grid item xs={4}></Grid>\n                                <Grid item xs={4}></Grid>\n                                <Grid item xs={4}></Grid>\n                            </Grid>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <p>Load: { load_selected.loadNumber || '--' }</p>\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <p>Broker: { load_selected.brokerage || '--' }</p>\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <p>Rate: { load_selected.rate || '--' }</p>\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <input\n                                    ref={rcfr} \n                                    onChange={event=> uploadDocument('rateConfirmation', event.target.files)}\n                                    type=\"file\" \n                                    name=\"rateConfirmation\" \n                                    multiple \n                                    style={{opacity: 0}}/>\n                                    <p style={{margin:0}}>\n                                        Rate Confirmation: \n                                        { \n                                            Array.isArray(load_selected.rateConfirmation) &&\n                                            load_selected.rateConfirmation.length > 0 && \n                                            typeof load_selected.rateConfirmation[0] !== 'string' ? \n                                            <Button \n                                            onClick={()=>deleteDocument('rateConfirmation')} \n                                            variant=\"contained\" \n                                            style={{backgroundColor:'red',color:'#ffffff'}}>\n                                            Delete\n                                            </Button> : \n                                            <Button \n                                            onClick={()=>rcfr.current.click()} \n                                            variant=\"contained\" color=\"primary\">\n                                            Upload\n                                            </Button>\n                                        }\n                                    </p>\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                            <Grid container spacing={2}>\n                                <Grid item xs={3}></Grid>\n                                <Grid item xs={6}>\n                                    <input\n                                    ref={pdfr} \n                                    onChange={event=> uploadDocument('proofDelivery', event.target.files)}\n                                    type=\"file\" \n                                    name=\"proofDelivery\" \n                                    multiple \n                                    style={{opacity: 0}}/>\n                                    <p style={{margin:0}}>\n                                        Proof of Delivery: \n                                        { \n                                            Array.isArray(load_selected.proofDelivery) && \n                                            load_selected.proofDelivery.length > 0 && \n                                            typeof load_selected.proofDelivery[0] !== 'string' ? \n                                            <Button \n                                            onClick={()=>deleteDocument('proofDelivery')} \n                                            variant=\"contained\" \n                                            style={{backgroundColor:'red',color:'#ffffff'}}>\n                                            Delete\n                                            </Button> : \n                                            <Button \n                                            onClick={()=>pdfr.current.click()} \n                                            variant=\"contained\" \n                                            color=\"primary\">\n                                            Upload\n                                            </Button>\n                                        }\n                                    </p>\n                                </Grid>\n                                <Grid item xs={3}></Grid>\n                            </Grid>\n                        </Grid> : '' }\n                    </div>\n                    <div className={classes.modalFooter}>\n                        <Grid item xs={12}>\n                            <Grid container spacing={2}>\n                                <Grid item xs={2}>\n                                    {\n                                        step !== 3 ?\n                                        (\n                                            <IconButton>\n                                                { step > 1 ? <ArrowBackIcon onClick={()=>changeStep('back')}/> : '' }\n                                            </IconButton>\n                                        ) : ''\n                                    }\n                                </Grid>\n                                <Grid item xs={2}></Grid>\n                                <Grid item xs={8} className={classes.btn_container}>\n                                    {\n                                        step !== 3 ?\n                                        (\n                                            <IconButton>\n                                                {/* { step > 1 ? <ArrowBackIcon onClick={()=>changeStep('back')}/> : '' } */}\n                                                <ArrowForwardIcon onClick={()=>changeStep('next')}/>\n                                            </IconButton>\n                                        ) : ''\n                                    }\n                                    { step === 3 ? <div>\n                                        <Button \n                                        variant=\"contained\" \n                                        color=\"primary\" \n                                        onClick={()=>changeStep('back')}\n                                        style={{marginRight:'5px'}}>Back</Button>\n                                        <Button variant=\"contained\" color=\"primary\" onClick={()=>handleSubmit()}>Create</Button>\n                                    </div> : '' }\n                                </Grid>\n                            </Grid>\n                        </Grid>\n                    </div>\n                </Grid>\n            </form>\n        </div>\n    </Modal>);\n}"]},"metadata":{},"sourceType":"module"}