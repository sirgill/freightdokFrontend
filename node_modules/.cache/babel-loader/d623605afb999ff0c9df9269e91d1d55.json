{"ast":null,"code":"var _jsxFileName = \"/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdok/client/src/components/users/UserForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\"\n  }\n}));\nconst initialState = {\n  email: '',\n  password: '',\n  role: ''\n};\n\nconst UserForm = () => {\n  _s();\n\n  const classes = useStyles();\n  const [form, setForm] = useState({ ...initialState\n  });\n  const {\n    loading,\n    open,\n    error,\n    user,\n    page,\n    limit\n  } = useSelector(state => state.users);\n  const {\n    user: auth\n  } = useSelector(state => state.auth);\n  const {\n    roles\n  } = useSelector(state => state.auth);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (!open) handleClose();\n  }, [open]);\n  useEffect(() => {\n    if (+page === 0) {\n      handleClose();\n      dispatch(fetchUsers(+page, +limit));\n    }\n  }, [page]);\n  useEffect(() => {\n    if (user) {\n      const {\n        email,\n        role\n      } = user;\n      setForm(f => ({ ...f,\n        email,\n        role\n      }));\n      dispatch(openModal());\n    }\n  }, [user]);\n\n  const handleChange = ({\n    target\n  }) => {\n    const {\n      name,\n      value\n    } = target;\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const handleClose = () => {\n    setForm({ ...initialState\n    });\n    dispatch(resetUserSelected());\n  };\n\n  const handleClickOpen = () => {\n    dispatch(openModal());\n  };\n\n  const getDiff = (local, actual) => {\n    const diffWithVal = {};\n    const localKeys = Object.keys(local);\n\n    for (let key of localKeys) {\n      if (key !== 'password' && actual[key] !== local[key]) diffWithVal[key] = local[key];\n      if (key === 'password' && local[key]) diffWithVal[key] = local[key];\n    }\n\n    return diffWithVal;\n  };\n\n  const onSubmit = () => {\n    if (!loading) {\n      if (!user) {\n        const {\n          email,\n          password,\n          role\n        } = form;\n        if (!email || !password || !role) return alert('All fields are required');\n        dispatch(registerUser(form));\n      } else {\n        const {\n          _id\n        } = user;\n        const dataToUpdate = getDiff(form, user);\n        dispatch(updateUser(dataToUpdate, _id));\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [auth && ['user'].indexOf(auth.role) > -1 || /*#__PURE__*/_jsxDEV(Fab, {\n      color: \"primary\",\n      onClick: handleClickOpen,\n      children: /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 57\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      fullWidth: true,\n      maxWidth: \"sm\",\n      open: open,\n      onClose: handleClose,\n      \"aria-labelledby\": \"form-dialog-title\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"form-dialog-title\",\n        children: [user ? 'Update' : 'Add', \" User\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this), error ? /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          textAlign: 'center'\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 23\n      }, this) : '', /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            className: classes.form,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: /*#__PURE__*/_jsxDEV(TextField, {\n                  id: \"outlined-basic\",\n                  type: \"email\",\n                  className: \"form-control\",\n                  name: \"email\",\n                  label: \"Email\",\n                  autoComplete: 'off',\n                  onChange: handleChange,\n                  value: form.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 102,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 113,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: /*#__PURE__*/_jsxDEV(TextField, {\n                  id: \"outlined-basic-p\",\n                  type: \"password\",\n                  className: \"form-control\",\n                  name: \"password\",\n                  label: \"Password\",\n                  autoComplete: 'off',\n                  onChange: handleChange,\n                  value: form.password\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 115,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                  id: \"userRoleLabel\",\n                  children: \"Role\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(Select, {\n                  style: {\n                    width: '100%'\n                  },\n                  labelId: \"userRoleLabel\",\n                  id: \"userRoleLabel\",\n                  value: form.role,\n                  name: \"role\",\n                  onChange: handleChange,\n                  children: roles.map(role => /*#__PURE__*/_jsxDEV(MenuItem, {\n                    value: role,\n                    children: capitalizeFirstLetter(role)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 60\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 1,\n              style: {\n                marginTop: \"20px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  className: \"\",\n                  onClick: onSubmit,\n                  children: \"Submit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(UserForm, \"J0y/gey8bG8chEu7P9jV4mO5CsU=\", false, function () {\n  return [useStyles, useSelector, useSelector, useSelector, useDispatch];\n});\n\n_c = UserForm;\nexport default UserForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserForm\");","map":{"version":3,"sources":["/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdok/client/src/components/users/UserForm.js"],"names":["React","useState","useEffect","Fab","AddIcon","Dialog","DialogContent","DialogTitle","TextField","Grid","Button","Select","InputLabel","MenuItem","makeStyles","useDispatch","useSelector","registerUser","resetUserSelected","updateUser","fetchUsers","openModal","capitalizeFirstLetter","useStyles","theme","form","display","flexDirection","margin","width","initialState","email","password","role","UserForm","classes","setForm","loading","open","error","user","page","limit","state","users","auth","roles","dispatch","handleClose","f","handleChange","target","name","value","handleClickOpen","getDiff","local","actual","diffWithVal","localKeys","Object","keys","key","onSubmit","alert","_id","dataToUpdate","indexOf","textAlign","map","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\",\n  }\n}));\n\nconst initialState = {\n    email: '', \n    password: '', \n    role: ''\n};\n\nconst UserForm = () => {\n    const classes = useStyles();\n    const [form, setForm] = useState({ ...initialState });\n    const { loading, open, error, user, page, limit } = useSelector(state => state.users);\n    const { user: auth } = useSelector(state => state.auth);\n    const { roles } = useSelector(state => state.auth);\n    const dispatch = useDispatch();\n    useEffect(() => {\n        if (!open) handleClose();\n    }, [open])\n    useEffect(() => {\n        if (+page === 0) {\n            handleClose();\n            dispatch(fetchUsers(+page, +limit));\n        }\n    }, [page])\n    useEffect(() => {\n        if (user) {\n            const { email, role } = user;\n            setForm(f => ({ ...f, email, role }));\n            dispatch(openModal());\n        }\n    }, [user]);\n    const handleChange = ({ target }) => {\n        const { name, value } = target;\n        setForm(f => ({ ...f, [name]: value }));\n    }\n    const handleClose = () => {\n        setForm({ ...initialState });\n        dispatch(resetUserSelected());\n    }\n    const handleClickOpen = () => {dispatch(openModal())}\n    const getDiff = (local, actual) => {\n        const diffWithVal = {};\n        const localKeys = Object.keys(local);\n        for (let key of localKeys) {\n            if (key !== 'password' && actual[key] !== local[key])\n                diffWithVal[key] = local[key];\n            if (key === 'password' && local[key])\n                diffWithVal[key] = local[key];   \n        }\n        return diffWithVal;\n    }\n    const onSubmit = () => {\n        if (!loading) {\n            if (!user) {\n                const { email, password, role } = form;\n                if (!email || !password || !role)\n                    return alert('All fields are required');\n                dispatch(registerUser(form));\n            } else {\n                const { _id } = user;\n                const dataToUpdate = getDiff(form, user);\n                dispatch(updateUser(dataToUpdate, _id));\n            }\n        }\n    }\n    return <>\n        { (auth && ['user'].indexOf(auth.role) > -1) || <Fab color=\"primary\" onClick={handleClickOpen}>\n            <AddIcon />\n        </Fab> }\n        <Dialog fullWidth={true} maxWidth={\"sm\"} open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\n            <DialogTitle id=\"form-dialog-title\">{ user ? 'Update' : 'Add' } User</DialogTitle>\n            { error ? <p style={{textAlign:'center'}}>{error}</p> : '' }\n            <DialogContent>\n                <div className=\"\">\n                    <form className={classes.form}>\n                        <div>\n                            <div className=\"form-group\">\n                                <TextField\n                                id=\"outlined-basic\"\n                                type=\"email\"\n                                className=\"form-control\"\n                                name=\"email\"\n                                label=\"Email\"\n                                autoComplete={'off'}\n                                onChange={handleChange}\n                                value={form.email}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <TextField\n                                id=\"outlined-basic-p\"\n                                type=\"password\"\n                                className=\"form-control\"\n                                name=\"password\"\n                                label=\"Password\"\n                                autoComplete={'off'}\n                                onChange={handleChange}\n                                value={form.password}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <InputLabel id=\"userRoleLabel\">Role</InputLabel>\n                                <Select\n                                    style={{width: '100%'}}\n                                    labelId=\"userRoleLabel\"\n                                    id=\"userRoleLabel\"\n                                    value={form.role}\n                                    name=\"role\"\n                                    onChange={handleChange}\n                                >\n                                    {\n                                        roles.map(role => (<MenuItem value={role}>{capitalizeFirstLetter(role)}</MenuItem>))\n                                    }\n                                </Select>\n                            </div>\n                        </div>\n                        <Grid container spacing={1} style={{ marginTop: \"20px\" }}>\n                            <Grid item xs={12}>\n                                <Button className=\"\" onClick={onSubmit}>Submit</Button>\n                            </Grid>\n                        </Grid>\n                    </form>\n                </div>\n            </DialogContent>\n        </Dialog>\n    </>\n}\n\nexport default UserForm;"]},"metadata":{},"sourceType":"module"}