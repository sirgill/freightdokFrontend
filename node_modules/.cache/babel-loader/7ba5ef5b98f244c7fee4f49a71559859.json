{"ast":null,"code":"var _jsxFileName = \"/Users/sunnygill/Desktop/freightdok/client/src/components/users/UserForm.js\";\nimport React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\nconst useStyles = makeStyles(theme => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\"\n  }\n}));\nconst initialState = {\n  email: '',\n  password: '',\n  role: ''\n};\n\nconst UserForm = () => {\n  const classes = useStyles();\n  const [form, setForm] = useState({ ...initialState\n  });\n  const {\n    loading,\n    open,\n    error,\n    user,\n    page,\n    limit\n  } = useSelector(state => state.users);\n  const {\n    user: auth\n  } = useSelector(state => state.auth);\n  const {\n    roles\n  } = useSelector(state => state.auth);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (!open) handleClose();\n  }, [open]);\n  useEffect(() => {\n    if (+page === 0) {\n      handleClose();\n      dispatch(fetchUsers(+page, +limit));\n    }\n  }, [page]);\n  useEffect(() => {\n    if (user) {\n      const {\n        email,\n        role\n      } = user;\n      setForm(f => ({ ...f,\n        email,\n        role\n      }));\n      dispatch(openModal());\n    }\n  }, [user]);\n\n  const handleChange = ({\n    target\n  }) => {\n    const {\n      name,\n      value\n    } = target;\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const handleClose = () => {\n    setForm({ ...initialState\n    });\n    dispatch(resetUserSelected());\n  };\n\n  const handleClickOpen = () => {\n    dispatch(openModal());\n  };\n\n  const getDiff = (local, actual) => {\n    const diffWithVal = {};\n    const localKeys = Object.keys(local);\n\n    for (let key of localKeys) {\n      if (key !== 'password' && actual[key] !== local[key]) diffWithVal[key] = local[key];\n      if (key === 'password' && local[key]) diffWithVal[key] = local[key];\n    }\n\n    return diffWithVal;\n  };\n\n  const onSubmit = () => {\n    if (!loading) {\n      if (!user) {\n        const {\n          email,\n          password,\n          role\n        } = form;\n        if (!email || !password || !role) return alert('All fields are required');\n        dispatch(registerUser(form));\n      } else {\n        const {\n          _id\n        } = user;\n        const dataToUpdate = getDiff(form, user);\n        dispatch(updateUser(dataToUpdate, _id));\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, auth && ['user'].indexOf(auth.role) > -1 || /*#__PURE__*/React.createElement(Fab, {\n    color: \"primary\",\n    onClick: handleClickOpen,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 57\n    }\n  }, /*#__PURE__*/React.createElement(AddIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Dialog, {\n    fullWidth: true,\n    maxWidth: \"sm\",\n    open: open,\n    onClose: handleClose,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DialogTitle, {\n    id: \"form-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, user ? 'Update' : 'Add', \" User\"), error ? /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 23\n    }\n  }, error) : '', /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: classes.form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"outlined-basic\",\n    type: \"email\",\n    className: \"form-control\",\n    name: \"email\",\n    label: \"Email\",\n    autoComplete: 'off',\n    onChange: handleChange,\n    value: form.email,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"outlined-basic-p\",\n    type: \"password\",\n    className: \"form-control\",\n    name: \"password\",\n    label: \"Password\",\n    autoComplete: 'off',\n    onChange: handleChange,\n    value: form.password,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    id: \"userRoleLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 33\n    }\n  }, \"Role\"), /*#__PURE__*/React.createElement(Select, {\n    style: {\n      width: '100%'\n    },\n    labelId: \"userRoleLabel\",\n    id: \"userRoleLabel\",\n    value: form.role,\n    name: \"role\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 33\n    }\n  }, roles.map(role => /*#__PURE__*/React.createElement(MenuItem, {\n    value: role,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 60\n    }\n  }, capitalizeFirstLetter(role)))))), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    style: {\n      marginTop: \"20px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    className: \"\",\n    onClick: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 33\n    }\n  }, \"Submit\"))))))));\n};\n\nexport default UserForm;","map":{"version":3,"sources":["/Users/sunnygill/Desktop/freightdok/client/src/components/users/UserForm.js"],"names":["React","useState","useEffect","Fab","AddIcon","Dialog","DialogContent","DialogTitle","TextField","Grid","Button","Select","InputLabel","MenuItem","makeStyles","useDispatch","useSelector","registerUser","resetUserSelected","updateUser","fetchUsers","openModal","capitalizeFirstLetter","useStyles","theme","form","display","flexDirection","margin","width","initialState","email","password","role","UserForm","classes","setForm","loading","open","error","user","page","limit","state","users","auth","roles","dispatch","handleClose","f","handleChange","target","name","value","handleClickOpen","getDiff","local","actual","diffWithVal","localKeys","Object","keys","key","onSubmit","alert","_id","dataToUpdate","indexOf","textAlign","map","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { registerUser, resetUserSelected, updateUser, fetchUsers, openModal } from '../../actions/users';\nimport { capitalizeFirstLetter } from '../../utils/helper';\n\nconst useStyles = makeStyles((theme) => ({\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    margin: \"auto\",\n    width: \"fit-content\",\n  }\n}));\n\nconst initialState = {\n    email: '', \n    password: '', \n    role: ''\n};\n\nconst UserForm = () => {\n    const classes = useStyles();\n    const [form, setForm] = useState({ ...initialState });\n    const { loading, open, error, user, page, limit } = useSelector(state => state.users);\n    const { user: auth } = useSelector(state => state.auth);\n    const { roles } = useSelector(state => state.auth);\n    const dispatch = useDispatch();\n    useEffect(() => {\n        if (!open) handleClose();\n    }, [open])\n    useEffect(() => {\n        if (+page === 0) {\n            handleClose();\n            dispatch(fetchUsers(+page, +limit));\n        }\n    }, [page])\n    useEffect(() => {\n        if (user) {\n            const { email, role } = user;\n            setForm(f => ({ ...f, email, role }));\n            dispatch(openModal());\n        }\n    }, [user]);\n    const handleChange = ({ target }) => {\n        const { name, value } = target;\n        setForm(f => ({ ...f, [name]: value }));\n    }\n    const handleClose = () => {\n        setForm({ ...initialState });\n        dispatch(resetUserSelected());\n    }\n    const handleClickOpen = () => {dispatch(openModal())}\n    const getDiff = (local, actual) => {\n        const diffWithVal = {};\n        const localKeys = Object.keys(local);\n        for (let key of localKeys) {\n            if (key !== 'password' && actual[key] !== local[key])\n                diffWithVal[key] = local[key];\n            if (key === 'password' && local[key])\n                diffWithVal[key] = local[key];   \n        }\n        return diffWithVal;\n    }\n    const onSubmit = () => {\n        if (!loading) {\n            if (!user) {\n                const { email, password, role } = form;\n                if (!email || !password || !role)\n                    return alert('All fields are required');\n                dispatch(registerUser(form));\n            } else {\n                const { _id } = user;\n                const dataToUpdate = getDiff(form, user);\n                dispatch(updateUser(dataToUpdate, _id));\n            }\n        }\n    }\n    return <>\n        { (auth && ['user'].indexOf(auth.role) > -1) || <Fab color=\"primary\" onClick={handleClickOpen}>\n            <AddIcon />\n        </Fab> }\n        <Dialog fullWidth={true} maxWidth={\"sm\"} open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\n            <DialogTitle id=\"form-dialog-title\">{ user ? 'Update' : 'Add' } User</DialogTitle>\n            { error ? <p style={{textAlign:'center'}}>{error}</p> : '' }\n            <DialogContent>\n                <div className=\"\">\n                    <form className={classes.form}>\n                        <div>\n                            <div className=\"form-group\">\n                                <TextField\n                                id=\"outlined-basic\"\n                                type=\"email\"\n                                className=\"form-control\"\n                                name=\"email\"\n                                label=\"Email\"\n                                autoComplete={'off'}\n                                onChange={handleChange}\n                                value={form.email}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <TextField\n                                id=\"outlined-basic-p\"\n                                type=\"password\"\n                                className=\"form-control\"\n                                name=\"password\"\n                                label=\"Password\"\n                                autoComplete={'off'}\n                                onChange={handleChange}\n                                value={form.password}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <InputLabel id=\"userRoleLabel\">Role</InputLabel>\n                                <Select\n                                    style={{width: '100%'}}\n                                    labelId=\"userRoleLabel\"\n                                    id=\"userRoleLabel\"\n                                    value={form.role}\n                                    name=\"role\"\n                                    onChange={handleChange}\n                                >\n                                    {\n                                        roles.map(role => (<MenuItem value={role}>{capitalizeFirstLetter(role)}</MenuItem>))\n                                    }\n                                </Select>\n                            </div>\n                        </div>\n                        <Grid container spacing={1} style={{ marginTop: \"20px\" }}>\n                            <Grid item xs={12}>\n                                <Button className=\"\" onClick={onSubmit}>Submit</Button>\n                            </Grid>\n                        </Grid>\n                    </form>\n                </div>\n            </DialogContent>\n        </Dialog>\n    </>\n}\n\nexport default UserForm;"]},"metadata":{},"sourceType":"module"}