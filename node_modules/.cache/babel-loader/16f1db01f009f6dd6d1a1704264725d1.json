{"ast":null,"code":"import axios from \"axios\";\nimport { setAlert } from \"./alert\";\nimport { GET_LOADS, GET_LOAD, LOAD_ERROR, ADD_LOAD, PATCH_PICKUP, PICKUP_ERROR, PATCH_DROP, DROP_ERROR, DELETE_LOAD, DELETE_LOAD_ERROR, UPDATE_LOAD, UPDATE_LOAD_ERROR, RETURNED_SEARCHED_LOADS, RESET_SEARCHED_LOADS, SELECT_LOAD, INVOICE_LOAD_FETCHED } from \"./types\";\nimport { proxy } from \"../../package.json\"; // Get current users loads\n\nexport const getLoads = (page = 0, limit = 5, module = '') => async dispatch => {\n  try {\n    axios.defaults.headers.common['x-auth-token'] = localStorage.token;\n    const url = `/api/load/me?page=${page + 1}&limit=${limit}&module=${module}`;\n    const res = await axios.get(url);\n    dispatch({\n      type: GET_LOADS,\n      payload: {\n        loads: res.data,\n        page,\n        limit\n      }\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\nexport const getInvoiceLoads = (page = 0, limit = 5, search = '') => async dispatch => {\n  try {\n    const url = `/api/load/invoice_loads?page=${page + 1}&limit=${limit}&search=${search}`;\n    const response = await axios.get(url);\n    const {\n      loads,\n      total,\n      totalPages\n    } = response.data;\n    dispatch({\n      type: INVOICE_LOAD_FETCHED,\n      payload: {\n        invoices: loads,\n        page,\n        limit,\n        search,\n        total,\n        totalPages\n      }\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\nexport const searchLoads = (page = 0, limit = 5, search = '', module = '') => async dispatch => {\n  try {\n    const url = `/api/load/me?page=${page + 1}&limit=${limit}&search=${search}&module=${module}`;\n    const res = await axios.get(url);\n    dispatch({\n      type: RETURNED_SEARCHED_LOADS,\n      payload: {\n        data: res.data,\n        page,\n        limit,\n        search\n      }\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\nexport const resetLoadsSearch = (listBarType = '') => async (dispatch, getState) => {\n  dispatch({\n    type: RESET_SEARCHED_LOADS\n  });\n  const {\n    load: {\n      page,\n      rowsPerPage\n    }\n  } = getState();\n  dispatch(getLoads(+page, +rowsPerPage, listBarType));\n};\nexport const selectLoad = (input = null) => ({\n  type: SELECT_LOAD,\n  payload: input\n}); // Get post\n\nexport const getLoad = id => async dispatch => {\n  try {\n    const res = await axios.get(`/loads/${id}`);\n    dispatch({\n      type: GET_LOAD,\n      payload: res.data\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n}; //add load\n\nexport const addLoad = formData => async dispatch => {\n  try {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    console.log('=========================  LOADINF...............');\n    const res = await axios.post(\"/api/load\", formData, config);\n    dispatch({\n      type: ADD_LOAD,\n      payload: res.data\n    });\n    dispatch(setAlert(\"Load Created\", \"success\"));\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\nexport const updateLoad = formData => async (dispatch, getState) => {\n  try {\n    const form = new FormData();\n\n    for (let key of Object.keys(formData)) {\n      if (['rateConfirmation', 'proofDelivery'].indexOf(key) < 0) {\n        const data = formData[key];\n        const isArray = Array.isArray(data);\n        const isNull = data === null;\n        let dataToSend = isArray && !isNull ? JSON.stringify(data) : data;\n        form.append(key, dataToSend);\n      }\n    }\n\n    for (let key of ['rateConfirmation', 'proofDelivery']) {\n      const files = formData[key];\n      if (files) for (let file of files) form.append(key, file);\n    }\n\n    await axios.patch(\"/api/load/modify\", form);\n    const {\n      load: {\n        search: {\n          page,\n          limit,\n          query\n        }\n      }\n    } = getState();\n    if (!query) dispatch(getLoads());else dispatch(searchLoads(page, limit, query));\n    dispatch(setAlert(\"Load Updated\", \"success\"));\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\nexport const downloadDocuments = file_name => {\n  axios({\n    url: proxy + \"/api/load/download/\" + file_name,\n    method: \"GET\",\n    responseType: 'blob'\n  }).then(res => {\n    const parts = res.config.url.split('/');\n    const name = parts[parts.length - 1];\n    const url = window.URL.createObjectURL(new Blob([res.data]));\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', name);\n    document.body.appendChild(link);\n    link.click();\n  });\n}; //add pickup\n//patch pickup\n\nexport const patchPickup = (load_id, pickup) => async dispatch => {\n  try {\n    const res = await axios.patch(`/api/load/pickup?load_id=${load_id}`, pickup);\n    dispatch({\n      type: PATCH_PICKUP,\n      payload: res.data\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n}; //patch drop\n\nexport const patchDrop = (load_id, drop) => async dispatch => {\n  try {\n    const res = await axios.patch(`/api/load/drop?load_id=${load_id}`, drop);\n    dispatch({\n      type: PATCH_DROP,\n      payload: res.date\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n}; // Delete a load\n\nexport const deleteLoad = load_id => async dispatch => {\n  try {\n    const res = await axios.delete(`/api/load`, {\n      data: {\n        load_id: load_id\n      }\n    });\n    console.log(\"RES:                 \", res);\n    dispatch({\n      type: DELETE_LOAD,\n      payload: load_id\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};","map":{"version":3,"sources":["/Users/sunnygill/Dropbox/My Mac (Surinders-MacBook-Pro.local)/Desktop/freightdok/client/src/actions/load.js"],"names":["axios","setAlert","GET_LOADS","GET_LOAD","LOAD_ERROR","ADD_LOAD","PATCH_PICKUP","PICKUP_ERROR","PATCH_DROP","DROP_ERROR","DELETE_LOAD","DELETE_LOAD_ERROR","UPDATE_LOAD","UPDATE_LOAD_ERROR","RETURNED_SEARCHED_LOADS","RESET_SEARCHED_LOADS","SELECT_LOAD","INVOICE_LOAD_FETCHED","proxy","getLoads","page","limit","module","dispatch","defaults","headers","common","localStorage","token","url","res","get","type","payload","loads","data","err","message","getInvoiceLoads","search","response","total","totalPages","invoices","searchLoads","resetLoadsSearch","listBarType","getState","load","rowsPerPage","selectLoad","input","getLoad","id","addLoad","formData","config","console","log","post","updateLoad","form","FormData","key","Object","keys","indexOf","isArray","Array","isNull","dataToSend","JSON","stringify","append","files","file","patch","query","downloadDocuments","file_name","method","responseType","then","parts","split","name","length","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","patchPickup","load_id","pickup","patchDrop","drop","date","deleteLoad","delete"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,SACAC,SADA,EAEAC,QAFA,EAGAC,UAHA,EAIAC,QAJA,EAKAC,YALA,EAMAC,YANA,EAOAC,UAPA,EAQAC,UARA,EASAC,WATA,EAUAC,iBAVA,EAWAC,WAXA,EAYAC,iBAZA,EAaAC,uBAbA,EAcAC,oBAdA,EAeAC,WAfA,EAgBAC,oBAhBA,QAiBO,SAjBP;AAmBA,SAASC,KAAT,QAAsB,oBAAtB,C,CAEA;;AACA,OAAO,MAAMC,QAAQ,GAAG,CAACC,IAAI,GAAG,CAAR,EAAWC,KAAK,GAAG,CAAnB,EAAsBC,MAAM,GAAG,EAA/B,KAAsC,MAAOC,QAAP,IAAoB;AAChF,MAAI;AACFvB,IAAAA,KAAK,CAACwB,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,cAA9B,IAAgDC,YAAY,CAACC,KAA7D;AACA,UAAMC,GAAG,GAAI,qBAAoBT,IAAI,GAAC,CAAE,UAASC,KAAM,WAAUC,MAAO,EAAxE;AACA,UAAMQ,GAAG,GAAG,MAAM9B,KAAK,CAAC+B,GAAN,CAAUF,GAAV,CAAlB;AACAN,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAE9B,SADC;AAEP+B,MAAAA,OAAO,EAAE;AAAEC,QAAAA,KAAK,EAAEJ,GAAG,CAACK,IAAb;AAAmBf,QAAAA,IAAnB;AAAyBC,QAAAA;AAAzB;AAFF,KAAD,CAAR;AAID,GARD,CAQE,OAAOe,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAZM;AAcP,OAAO,MAAMC,eAAe,GAAG,CAAClB,IAAI,GAAG,CAAR,EAAWC,KAAK,GAAG,CAAnB,EAAsBkB,MAAM,GAAG,EAA/B,KAAsC,MAAMhB,QAAN,IAAkB;AACrF,MAAI;AACF,UAAMM,GAAG,GAAI,gCAA+BT,IAAI,GAAC,CAAE,UAASC,KAAM,WAAUkB,MAAO,EAAnF;AACA,UAAMC,QAAQ,GAAG,MAAMxC,KAAK,CAAC+B,GAAN,CAAUF,GAAV,CAAvB;AACA,UAAM;AAAEK,MAAAA,KAAF;AAASO,MAAAA,KAAT;AAAgBC,MAAAA;AAAhB,QAA+BF,QAAQ,CAACL,IAA9C;AACAZ,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAEf,oBADC;AAEPgB,MAAAA,OAAO,EAAE;AAAEU,QAAAA,QAAQ,EAAET,KAAZ;AAAmBd,QAAAA,IAAnB;AAAyBC,QAAAA,KAAzB;AAAgCkB,QAAAA,MAAhC;AAAwCE,QAAAA,KAAxC;AAA+CC,QAAAA;AAA/C;AAFF,KAAD,CAAR;AAID,GARD,CAQE,OAAON,GAAP,EAAY;AAAEb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AAA2C;AAC5D,CAVM;AAYP,OAAO,MAAMO,WAAW,GAAG,CAACxB,IAAI,GAAG,CAAR,EAAWC,KAAK,GAAG,CAAnB,EAAsBkB,MAAM,GAAG,EAA/B,EAAmCjB,MAAM,GAAG,EAA5C,KAAmD,MAAMC,QAAN,IAAkB;AAC9F,MAAI;AACF,UAAMM,GAAG,GAAI,qBAAoBT,IAAI,GAAC,CAAE,UAASC,KAAM,WAAUkB,MAAO,WAAUjB,MAAO,EAAzF;AACA,UAAMQ,GAAG,GAAG,MAAM9B,KAAK,CAAC+B,GAAN,CAAUF,GAAV,CAAlB;AACAN,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAElB,uBADC;AAEPmB,MAAAA,OAAO,EAAE;AAAEE,QAAAA,IAAI,EAAEL,GAAG,CAACK,IAAZ;AAAkBf,QAAAA,IAAlB;AAAwBC,QAAAA,KAAxB;AAA+BkB,QAAAA;AAA/B;AAFF,KAAD,CAAR;AAID,GAPD,CAOE,OAAOH,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAXM;AAaP,OAAO,MAAMQ,gBAAgB,GAAG,CAACC,WAAW,GAAG,EAAf,KAAsB,OAAOvB,QAAP,EAAiBwB,QAAjB,KAA8B;AAClFxB,EAAAA,QAAQ,CAAC;AAACS,IAAAA,IAAI,EAAEjB;AAAP,GAAD,CAAR;AACA,QAAM;AAAEiC,IAAAA,IAAI,EAAE;AAAE5B,MAAAA,IAAF;AAAQ6B,MAAAA;AAAR;AAAR,MAAkCF,QAAQ,EAAhD;AACAxB,EAAAA,QAAQ,CAACJ,QAAQ,CAAC,CAACC,IAAF,EAAQ,CAAC6B,WAAT,EAAsBH,WAAtB,CAAT,CAAR;AACD,CAJM;AAMP,OAAO,MAAMI,UAAU,GAAG,CAACC,KAAK,GAAG,IAAT,MAAmB;AAC3CnB,EAAAA,IAAI,EAAEhB,WADqC;AAE3CiB,EAAAA,OAAO,EAAEkB;AAFkC,CAAnB,CAAnB,C,CAKP;;AACA,OAAO,MAAMC,OAAO,GAAIC,EAAD,IAAQ,MAAO9B,QAAP,IAAoB;AACjD,MAAI;AACF,UAAMO,GAAG,GAAG,MAAM9B,KAAK,CAAC+B,GAAN,CAAW,UAASsB,EAAG,EAAvB,CAAlB;AAEA9B,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAE7B,QADC;AAEP8B,MAAAA,OAAO,EAAEH,GAAG,CAACK;AAFN,KAAD,CAAR;AAID,GAPD,CAOE,OAAOC,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAXM,C,CAaP;;AACA,OAAO,MAAMiB,OAAO,GAAIC,QAAD,IAAc,MAAOhC,QAAP,IAAoB;AACvD,MAAI;AACF,UAAMiC,MAAM,GAAG;AACb/B,MAAAA,OAAO,EAAE;AACP,wBAAgB;AADT;AADI,KAAf;AAKAgC,IAAAA,OAAO,CAACC,GAAR,CAAY,mDAAZ;AACA,UAAM5B,GAAG,GAAG,MAAM9B,KAAK,CAAC2D,IAAN,CAAW,WAAX,EAAwBJ,QAAxB,EAAkCC,MAAlC,CAAlB;AAEAjC,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAE3B,QADC;AAEP4B,MAAAA,OAAO,EAAEH,GAAG,CAACK;AAFN,KAAD,CAAR;AAKAZ,IAAAA,QAAQ,CAACtB,QAAQ,CAAC,cAAD,EAAiB,SAAjB,CAAT,CAAR;AACD,GAfD,CAeE,OAAOmC,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAnBM;AAqBP,OAAO,MAAMuB,UAAU,GAAIL,QAAD,IAAc,OAAOhC,QAAP,EAAiBwB,QAAjB,KAA8B;AACpE,MAAI;AACF,UAAMc,IAAI,GAAG,IAAIC,QAAJ,EAAb;;AACA,SAAK,IAAIC,GAAT,IAAgBC,MAAM,CAACC,IAAP,CAAYV,QAAZ,CAAhB,EAAuC;AACrC,UAAI,CAAC,kBAAD,EAAqB,eAArB,EAAsCW,OAAtC,CAA8CH,GAA9C,IAAqD,CAAzD,EAA4D;AAC1D,cAAM5B,IAAI,GAAGoB,QAAQ,CAACQ,GAAD,CAArB;AACA,cAAMI,OAAO,GAAGC,KAAK,CAACD,OAAN,CAAchC,IAAd,CAAhB;AACA,cAAMkC,MAAM,GAAGlC,IAAI,KAAK,IAAxB;AACA,YAAImC,UAAU,GAAGH,OAAO,IAAI,CAACE,MAAZ,GAAqBE,IAAI,CAACC,SAAL,CAAerC,IAAf,CAArB,GAA4CA,IAA7D;AACA0B,QAAAA,IAAI,CAACY,MAAL,CAAYV,GAAZ,EAAiBO,UAAjB;AACD;AACF;;AACD,SAAK,IAAIP,GAAT,IAAgB,CAAC,kBAAD,EAAqB,eAArB,CAAhB,EAAuD;AACrD,YAAMW,KAAK,GAAGnB,QAAQ,CAACQ,GAAD,CAAtB;AACA,UAAIW,KAAJ,EACE,KAAK,IAAIC,IAAT,IAAiBD,KAAjB,EACEb,IAAI,CAACY,MAAL,CAAYV,GAAZ,EAAiBY,IAAjB;AACL;;AACD,UAAM3E,KAAK,CAAC4E,KAAN,CAAY,kBAAZ,EAAgCf,IAAhC,CAAN;AACA,UAAM;AAAEb,MAAAA,IAAI,EAAE;AAAET,QAAAA,MAAM,EAAE;AAAEnB,UAAAA,IAAF;AAAQC,UAAAA,KAAR;AAAewD,UAAAA;AAAf;AAAV;AAAR,QAA+C9B,QAAQ,EAA7D;AACA,QAAI,CAAC8B,KAAL,EACEtD,QAAQ,CAACJ,QAAQ,EAAT,CAAR,CADF,KAGEI,QAAQ,CAACqB,WAAW,CAACxB,IAAD,EAAOC,KAAP,EAAcwD,KAAd,CAAZ,CAAR;AACFtD,IAAAA,QAAQ,CAACtB,QAAQ,CAAC,cAAD,EAAiB,SAAjB,CAAT,CAAR;AACD,GAxBD,CAwBE,OAAOmC,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CA5BM;AA8BP,OAAO,MAAMyC,iBAAiB,GAAIC,SAAD,IAAe;AAC9C/E,EAAAA,KAAK,CAAC;AACJ6B,IAAAA,GAAG,EAAEX,KAAK,GAAG,qBAAR,GAAgC6D,SADjC;AAEJC,IAAAA,MAAM,EAAE,KAFJ;AAGJC,IAAAA,YAAY,EAAE;AAHV,GAAD,CAAL,CAKCC,IALD,CAKMpD,GAAG,IAAI;AACX,UAAMqD,KAAK,GAAGrD,GAAG,CAAC0B,MAAJ,CAAW3B,GAAX,CAAeuD,KAAf,CAAqB,GAArB,CAAd;AACA,UAAMC,IAAI,GAAGF,KAAK,CAACA,KAAK,CAACG,MAAN,GAAe,CAAhB,CAAlB;AACA,UAAMzD,GAAG,GAAG0D,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2B,IAAIC,IAAJ,CAAS,CAAC5D,GAAG,CAACK,IAAL,CAAT,CAA3B,CAAZ;AACA,UAAMwD,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAb;AACAF,IAAAA,IAAI,CAACG,IAAL,GAAYjE,GAAZ;AACA8D,IAAAA,IAAI,CAACI,YAAL,CAAkB,UAAlB,EAA8BV,IAA9B;AACAO,IAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,IAA1B;AACAA,IAAAA,IAAI,CAACO,KAAL;AACD,GAdD;AAeD,CAhBM,C,CAkBP;AAEA;;AACA,OAAO,MAAMC,WAAW,GAAG,CAACC,OAAD,EAAUC,MAAV,KAAqB,MAAO9E,QAAP,IAAoB;AAClE,MAAI;AACF,UAAMO,GAAG,GAAG,MAAM9B,KAAK,CAAC4E,KAAN,CAAa,4BAA2BwB,OAAQ,EAAhD,EAAmDC,MAAnD,CAAlB;AACA9E,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAE1B,YADC;AAEP2B,MAAAA,OAAO,EAAEH,GAAG,CAACK;AAFN,KAAD,CAAR;AAID,GAND,CAME,OAAOC,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAVM,C,CAYP;;AACA,OAAO,MAAMiE,SAAS,GAAG,CAACF,OAAD,EAAUG,IAAV,KAAmB,MAAOhF,QAAP,IAAoB;AAC9D,MAAI;AACF,UAAMO,GAAG,GAAG,MAAM9B,KAAK,CAAC4E,KAAN,CAAa,0BAAyBwB,OAAQ,EAA9C,EAAiDG,IAAjD,CAAlB;AACAhF,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAExB,UADC;AAEPyB,MAAAA,OAAO,EAAEH,GAAG,CAAC0E;AAFN,KAAD,CAAR;AAID,GAND,CAME,OAAOpE,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAVM,C,CAYP;;AACA,OAAO,MAAMoE,UAAU,GAAIL,OAAD,IAAa,MAAO7E,QAAP,IAAoB;AACzD,MAAI;AACF,UAAMO,GAAG,GAAG,MAAM9B,KAAK,CAAC0G,MAAN,CAAc,WAAd,EAA0B;AAAEvE,MAAAA,IAAI,EAAE;AAAEiE,QAAAA,OAAO,EAAEA;AAAX;AAAR,KAA1B,CAAlB;AACA3C,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqC5B,GAArC;AACAP,IAAAA,QAAQ,CAAC;AACPS,MAAAA,IAAI,EAAEtB,WADC;AAEPuB,MAAAA,OAAO,EAAEmE;AAFF,KAAD,CAAR;AAID,GAPD,CAOE,OAAOhE,GAAP,EAAY;AACZb,IAAAA,QAAQ,CAACtB,QAAQ,CAACmC,GAAG,CAACC,OAAL,EAAc,OAAd,CAAT,CAAR;AACD;AACF,CAXM","sourcesContent":["import axios from \"axios\";\nimport { setAlert } from \"./alert\";\nimport { \nGET_LOADS, \nGET_LOAD, \nLOAD_ERROR, \nADD_LOAD, \nPATCH_PICKUP, \nPICKUP_ERROR, \nPATCH_DROP, \nDROP_ERROR, \nDELETE_LOAD, \nDELETE_LOAD_ERROR, \nUPDATE_LOAD, \nUPDATE_LOAD_ERROR,\nRETURNED_SEARCHED_LOADS,\nRESET_SEARCHED_LOADS,\nSELECT_LOAD,\nINVOICE_LOAD_FETCHED\n} from \"./types\";\n\nimport { proxy } from \"../../package.json\";\n\n// Get current users loads\nexport const getLoads = (page = 0, limit = 5, module = '') => async (dispatch) => {\n  try {\n    axios.defaults.headers.common['x-auth-token'] = localStorage.token;\n    const url = `/api/load/me?page=${page+1}&limit=${limit}&module=${module}`;\n    const res = await axios.get(url);\n    dispatch({\n      type: GET_LOADS,\n      payload: { loads: res.data, page, limit },\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\n\nexport const getInvoiceLoads = (page = 0, limit = 5, search = '') => async dispatch => {\n  try {\n    const url = `/api/load/invoice_loads?page=${page+1}&limit=${limit}&search=${search}`;\n    const response = await axios.get(url);\n    const { loads, total, totalPages } = response.data;\n    dispatch({\n      type: INVOICE_LOAD_FETCHED,\n      payload: { invoices: loads, page, limit, search, total, totalPages }\n    })\n  } catch (err) { dispatch(setAlert(err.message, \"error\")); }\n}\n\nexport const searchLoads = (page = 0, limit = 5, search = '', module = '') => async dispatch => {\n  try {\n    const url = `/api/load/me?page=${page+1}&limit=${limit}&search=${search}&module=${module}`;\n    const res = await axios.get(url);\n    dispatch({\n      type: RETURNED_SEARCHED_LOADS,\n      payload: { data: res.data, page, limit, search },\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n}\n\nexport const resetLoadsSearch = (listBarType = '') => async (dispatch, getState) => {\n  dispatch({type: RESET_SEARCHED_LOADS});\n  const { load: { page, rowsPerPage } } = getState();\n  dispatch(getLoads(+page, +rowsPerPage, listBarType));\n};\n\nexport const selectLoad = (input = null) => ({\n  type: SELECT_LOAD,\n  payload: input\n});\n\n// Get post\nexport const getLoad = (id) => async (dispatch) => {\n  try {\n    const res = await axios.get(`/loads/${id}`);\n\n    dispatch({\n      type: GET_LOAD,\n      payload: res.data,\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\n\n//add load\nexport const addLoad = (formData) => async (dispatch) => {\n  try {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    console.log('=========================  LOADINF...............');\n    const res = await axios.post(\"/api/load\", formData, config);\n\n    dispatch({\n      type: ADD_LOAD,\n      payload: res.data,\n    });\n\n    dispatch(setAlert(\"Load Created\", \"success\"));\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\n\nexport const updateLoad = (formData) => async (dispatch, getState) => {\n  try {\n    const form = new FormData();\n    for (let key of Object.keys(formData)) {\n      if (['rateConfirmation', 'proofDelivery'].indexOf(key) < 0) {\n        const data = formData[key];\n        const isArray = Array.isArray(data);\n        const isNull = data === null;\n        let dataToSend = isArray && !isNull ? JSON.stringify(data) : data;\n        form.append(key, dataToSend);\n      }\n    }\n    for (let key of ['rateConfirmation', 'proofDelivery']) {\n      const files = formData[key];\n      if (files)\n        for (let file of files)\n          form.append(key, file);\n    }\n    await axios.patch(\"/api/load/modify\", form);\n    const { load: { search: { page, limit, query } } } = getState();\n    if (!query)\n      dispatch(getLoads());\n    else\n      dispatch(searchLoads(page, limit, query));\n    dispatch(setAlert(\"Load Updated\", \"success\"));\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n}\n\nexport const downloadDocuments = (file_name) => {\n  axios({\n    url: proxy + \"/api/load/download/\" + file_name,\n    method: \"GET\",\n    responseType: 'blob'\n  })\n  .then(res => {\n    const parts = res.config.url.split('/');\n    const name = parts[parts.length - 1];\n    const url = window.URL.createObjectURL(new Blob([res.data]))\n    const link = document.createElement('a')\n    link.href = url\n    link.setAttribute('download', name);\n    document.body.appendChild(link);\n    link.click()\n  });\n}\n\n//add pickup\n\n//patch pickup\nexport const patchPickup = (load_id, pickup) => async (dispatch) => {\n  try {\n    const res = await axios.patch(`/api/load/pickup?load_id=${load_id}`, pickup);\n    dispatch({\n      type: PATCH_PICKUP,\n      payload: res.data,\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\n\n//patch drop\nexport const patchDrop = (load_id, drop) => async (dispatch) => {\n  try {\n    const res = await axios.patch(`/api/load/drop?load_id=${load_id}`, drop);\n    dispatch({\n      type: PATCH_DROP,\n      payload: res.date,\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};\n\n// Delete a load\nexport const deleteLoad = (load_id) => async (dispatch) => {\n  try {\n    const res = await axios.delete(`/api/load`, { data: { load_id: load_id } });\n    console.log(\"RES:                 \", res);\n    dispatch({\n      type: DELETE_LOAD,\n      payload: load_id,\n    });\n  } catch (err) {\n    dispatch(setAlert(err.message, \"error\"));\n  }\n};"]},"metadata":{},"sourceType":"module"}